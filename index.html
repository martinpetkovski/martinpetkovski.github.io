<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="color-scheme" content="dark" />
	<title>najjak.com</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Cinzel:wght@400;700&family=Fira+Code:wght@400&display=swap" rel="stylesheet">
	<style>
        * { box-sizing: border-box; }
        html, body { width: 100%; overflow-x: hidden; margin: 0; padding: 0; }
        
        @property --angle {
            syntax: '<angle>';
            initial-value: 0deg;
            inherits: false;
        }

        :root {
            --bg-dark: #050505;
            --panel-bg: #111;
            --text-main: #eee;
            --text-dim: #555;
            --accent: #ffffff;
            --accent-2: #ff003c;
            --accent-3: #eaff00;
            --shadow-color: #000;
            --depth: 8px;
        }

        @keyframes scanline {
            0% { background-position: 0% 0%; }
            100% { background-position: 0% 100%; }
        }

        @keyframes float {
            0% { transform: translateY(0px) rotateX(10deg); }
            50% { transform: translateY(-5px) rotateX(10deg); }
            100% { transform: translateY(0px) rotateX(10deg); }
        }

        @keyframes border-rotate {
            to { --angle: 360deg; }
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: perspective(1000px) translate3d(0, 40px, -50px) rotateX(-20deg); }
            to { opacity: 1; transform: perspective(1000px) translate3d(0, 0, 0) rotateX(0); }
        }

        @keyframes text-glow {
            0%, 100% { text-shadow: 3px 3px 0px #000, 0 0 20px rgba(255, 255, 255, 0.6); }
            50% { text-shadow: 3px 3px 0px #000, 0 0 30px rgba(255, 255, 255, 0.8), 0 0 10px rgba(100, 200, 255, 0.4); }
        }

        @keyframes shine {
            0% { left: -100%; opacity: 0; }
            20% { opacity: 1; }
            100% { left: 200%; opacity: 0; }
        }

        @keyframes filmGrain {
            0%, 100% { transform: translate3d(0, 0, 0); }
            50% { transform: translate3d(-1%, -1%, 0); }
        }

        @keyframes lightLeak {
            0% { opacity: 0; transform: translateX(-100%) rotate(-5deg); }
            15% { opacity: 0.4; }
            50% { opacity: 0.2; transform: translateX(50%) rotate(5deg); }
            85% { opacity: 0.3; }
            100% { opacity: 0; transform: translateX(100%) rotate(-5deg); }
        }

        @keyframes chromaShift {
            0%, 100% { filter: none; }
            25% { filter: drop-shadow(2px 0 0 rgba(255,0,0,0.3)) drop-shadow(-2px 0 0 rgba(0,255,255,0.3)); }
            50% { filter: drop-shadow(0 2px 0 rgba(255,0,0,0.2)) drop-shadow(0 -2px 0 rgba(0,255,255,0.2)); }
            75% { filter: drop-shadow(-1px 1px 0 rgba(255,0,0,0.3)) drop-shadow(1px -1px 0 rgba(0,255,255,0.3)); }
        }

        @keyframes lensFlare {
            0% { opacity: 0; transform: scale(0.5) translateX(-200%); }
            20% { opacity: 0.8; }
            50% { opacity: 0.4; transform: scale(1.2) translateX(0); }
            80% { opacity: 0.6; }
            100% { opacity: 0; transform: scale(0.8) translateX(200%); }
        }

        @keyframes projectorFlicker {
            0%, 100% { opacity: 1; }
            5% { opacity: 0.97; }
            10% { opacity: 1; }
            15% { opacity: 0.98; }
            50% { opacity: 1; }
            55% { opacity: 0.96; }
            60% { opacity: 1; }
        }

        @keyframes cinematicPulse {
            0%, 100% { box-shadow: 0 0 0 rgba(255,255,255,0); }
            50% { box-shadow: 0 0 100px rgba(255,255,255,0.05); }
        }

        @keyframes depthPush {
            from { transform: perspective(1000px) translateZ(-100px) rotateX(10deg); opacity: 0; filter: blur(10px); }
            to { transform: perspective(1000px) translateZ(0) rotateX(0); opacity: 1; filter: blur(0); }
        }

        @keyframes horizontalScan {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100vh); }
        }

        @keyframes subtleZoom {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        /* 3D Floating Animation */
        @keyframes float3D {
            0%, 100% { transform: perspective(1000px) translateY(0) translateZ(0) rotateX(0) rotateY(0); }
            25% { transform: perspective(1000px) translateY(-10px) translateZ(20px) rotateX(2deg) rotateY(-1deg); }
            50% { transform: perspective(1000px) translateY(-5px) translateZ(10px) rotateX(0) rotateY(1deg); }
            75% { transform: perspective(1000px) translateY(-15px) translateZ(30px) rotateX(-1deg) rotateY(0); }
        }

        /* Dolly Zoom Effect */
        @keyframes dollyZoom {
            0% { transform: perspective(800px) translateZ(0) scale(1); }
            50% { transform: perspective(400px) translateZ(-50px) scale(1.15); }
            100% { transform: perspective(800px) translateZ(0) scale(1); }
        }

        /* Cinematic Rack Focus */
        @keyframes rackFocus {
            0%, 100% { filter: blur(0); }
            50% { filter: blur(3px); }
        }

        /* Ken Burns Effect */
        @keyframes kenBurns {
            0% { transform: scale(1) translate(0, 0); }
            100% { transform: scale(1.1) translate(-2%, -1%); }
        }

        /* Parallax Float */
        @keyframes parallaxFloat {
            0%, 100% { transform: translate3d(0, 0, 0); }
            50% { transform: translate3d(10px, -20px, 50px); }
        }

        /* Orbit Animation */
        @keyframes orbit {
            0% { transform: rotateY(0deg) translateZ(100px) rotateY(0deg); }
            100% { transform: rotateY(360deg) translateZ(100px) rotateY(-360deg); }
        }

        /* Breathing Glow */
        @keyframes breathingGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(255,255,255,0.1), inset 0 0 20px rgba(255,255,255,0.05); }
            50% { box-shadow: 0 0 40px rgba(255,255,255,0.2), inset 0 0 40px rgba(255,255,255,0.1); }
        }

        /* Spotlight Sweep */
        @keyframes spotlightSweep {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        /* 3D Card Flip Idle */
        @keyframes cardIdle {
            0%, 100% { transform: perspective(1000px) rotateY(0deg) rotateX(0deg); }
            25% { transform: perspective(1000px) rotateY(1deg) rotateX(0.5deg); }
            75% { transform: perspective(1000px) rotateY(-1deg) rotateX(-0.5deg); }
        }

        /* Ambient Movement for Background */
        @keyframes ambientDrift {
            0% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -20px) scale(1.02); }
            66% { transform: translate(-20px, 30px) scale(0.98); }
            100% { transform: translate(0, 0) scale(1); }
        }

        /* Film Reel Shake */
        @keyframes reelShake {
            0%, 100% { transform: translate3d(0, 0, 0); }
            25% { transform: translate3d(-1px, 1px, 0); }
            50% { transform: translate3d(1px, -1px, 0); }
            75% { transform: translate3d(-1px, -1px, 0); }
        }

        /* Ribbon Particle Animation */
        @keyframes ribbonFloat {
            0% { 
                transform: translate(0, 0) rotate(0deg) scale(1);
                opacity: 1;
            }
            100% { 
                transform: translate(var(--ribbon-tx), var(--ribbon-ty)) rotate(var(--ribbon-rotate)) scale(0);
                opacity: 0;
            }
        }

        @keyframes ribbonWave {
            0%, 100% { transform: translateY(0) scaleX(1); }
            25% { transform: translateY(-3px) scaleX(0.95); }
            50% { transform: translateY(0) scaleX(1.05); }
            75% { transform: translateY(3px) scaleX(0.97); }
        }

        @keyframes ribbonTrail {
            0% { 
                width: 0;
                opacity: 0.8;
            }
            50% { 
                width: var(--trail-width);
                opacity: 0.6;
            }
            100% { 
                width: 0;
                opacity: 0;
            }
        }

        /* Enhanced Title Glitch Effect */
        @keyframes glitchEnhanced {
            0%, 90%, 100% { 
                text-shadow: 0 0 20px rgba(255, 255, 255, 0.3); 
                transform: translate(0); 
                filter: none;
            }
            1% { 
                text-shadow: 3px 3px 0px #ff003c, -3px -3px 0px #00eaff; 
                transform: translate(-3px, 2px) skewX(-2deg); 
                filter: hue-rotate(90deg);
            }
            2% { 
                text-shadow: -2px -2px 0px #ff003c, 2px 2px 0px #00eaff, 0 0 30px #fff; 
                transform: translate(3px, -2px) skewX(3deg);
                filter: hue-rotate(-90deg) saturate(2);
            }
            3% { 
                text-shadow: 0 0 20px rgba(255, 255, 255, 0.3); 
                transform: translate(0); 
                filter: none;
            }
            45% { 
                text-shadow: 0 0 20px rgba(255, 255, 255, 0.3); 
                transform: translate(0); 
                clip-path: inset(0 0 0 0);
            }
            46% { 
                text-shadow: 5px 0 0 #ff003c, -5px 0 0 #00eaff; 
                transform: translate(-5px, 0);
                clip-path: inset(20% 0 30% 0);
            }
            47% { 
                text-shadow: -5px 0 0 #ff003c, 5px 0 0 #00eaff; 
                transform: translate(5px, 0);
                clip-path: inset(50% 0 20% 0);
            }
            48% { 
                text-shadow: 0 0 20px rgba(255, 255, 255, 0.3); 
                transform: translate(0);
                clip-path: inset(0 0 0 0);
            }
        }

        @keyframes glitchLine {
            0%, 100% { transform: translateX(-100%); opacity: 0; }
            45%, 55% { transform: translateX(0); opacity: 1; }
        }

        @keyframes glitchNoise {
            0%, 100% { background-position: 0 0; }
            33% { background-position: -5% -10%; }
            66% { background-position: 5% 10%; }
        }

        /* Footer Reveal Animation */
        @keyframes footerReveal {
            from {
                opacity: 0;
                transform: translateY(100%);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Link Scroll Animation */
        @keyframes linkRevealSlide {
            from {
                opacity: 0;
                transform: translateX(var(--link-slide-dir, -40px)) translateY(20px) scale(0.95);
                filter: blur(4px);
            }
            to {
                opacity: 1;
                transform: translateX(0) translateY(0) scale(1);
                filter: blur(0);
            }
        }

        @keyframes linkHoverPulse {
            0%, 100% { box-shadow: 0 4px 6px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1); }
            50% { box-shadow: 0 8px 20px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.2), 0 0 30px rgba(255,200,100,0.1); }
        }

        /* Ribbon Wrap Effect on Links - Cinematic */
        .ribbon-wrap {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            overflow: hidden;
            z-index: 5;
        }

        .ribbon-wrap::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(105deg, 
                transparent 0%,
                transparent 30%,
                rgba(255, 200, 150, 0.08) 38%,
                rgba(255, 220, 180, 0.25) 45%,
                rgba(255, 255, 255, 0.7) 50%,
                rgba(255, 220, 180, 0.25) 55%,
                rgba(255, 200, 150, 0.08) 62%,
                transparent 70%,
                transparent 100%
            );
            transform: translateX(-150%);
            opacity: 0;
            filter: blur(1px);
        }

        a.link:hover .ribbon-wrap::before {
            animation: ribbonSweep 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        }

        @keyframes ribbonSweep {
            0% {
                transform: translateX(-150%);
                opacity: 0;
            }
            15% {
                opacity: 1;
            }
            85% {
                opacity: 1;
            }
            100% {
                transform: translateX(150%);
                opacity: 0;
            }
        }

        /* Ribbon particle that traces the border - sleek version */
        .ribbon-particle-wrap {
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            pointer-events: none;
            z-index: 6;
            overflow: visible;
        }

        .ribbon-dot {
            position: absolute;
            width: 40px;
            height: 3px;
            background: linear-gradient(90deg, 
                transparent 0%,
                rgba(255, 180, 120, 0.6) 15%,
                rgba(255, 220, 180, 0.9) 40%,
                rgba(255, 255, 255, 1) 50%,
                rgba(255, 220, 180, 0.9) 60%,
                rgba(255, 180, 120, 0.6) 85%,
                transparent 100%
            );
            border-radius: 2px;
            box-shadow: 
                0 0 8px rgba(255, 200, 150, 0.8),
                0 0 20px rgba(255, 180, 120, 0.5),
                0 0 35px rgba(255, 150, 100, 0.3);
            opacity: 0;
            transform-origin: center center;
        }

        /* Secondary trailing dot */
        .ribbon-dot-trail {
            position: absolute;
            width: 25px;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent 0%,
                rgba(255, 200, 150, 0.5) 30%,
                rgba(255, 220, 180, 0.7) 50%,
                rgba(255, 200, 150, 0.5) 70%,
                transparent 100%
            );
            border-radius: 1px;
            box-shadow: 0 0 10px rgba(255, 180, 120, 0.4);
            opacity: 0;
        }

        a.link:hover .ribbon-dot {
            animation: ribbonTrace 1s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        a.link:hover .ribbon-dot-trail {
            animation: ribbonTrace 1s cubic-bezier(0.4, 0, 0.2, 1) 0.08s forwards;
        }

        @keyframes ribbonTrace {
            0% {
                top: -1px;
                left: -20px;
                opacity: 0;
                transform: rotate(0deg);
            }
            5% {
                opacity: 1;
            }
            25% {
                top: -1px;
                left: calc(100% - 20px);
                transform: rotate(0deg);
            }
            26% {
                transform: rotate(90deg);
            }
            50% {
                top: calc(100% - 1px);
                left: calc(100% - 20px);
                transform: rotate(90deg);
            }
            51% {
                transform: rotate(180deg);
            }
            75% {
                top: calc(100% - 1px);
                left: -20px;
                transform: rotate(180deg);
            }
            76% {
                transform: rotate(270deg);
            }
            95% {
                opacity: 1;
            }
            100% {
                top: -1px;
                left: -20px;
                transform: rotate(270deg);
                opacity: 0;
            }
        }

        /* Glowing border trace effect */
        .ribbon-glow {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 4;
            opacity: 0;
        }

        a.link:hover .ribbon-glow {
            animation: ribbonGlowTrace 1s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes ribbonGlowTrace {
            0% {
                box-shadow: inset 0 2px 0 rgba(255, 200, 150, 0.6);
                opacity: 1;
            }
            25% {
                box-shadow: inset -2px 0 0 rgba(255, 200, 150, 0.6), inset 0 2px 0 rgba(255, 200, 150, 0.2);
            }
            50% {
                box-shadow: inset 0 -2px 0 rgba(255, 200, 150, 0.6), inset -2px 0 0 rgba(255, 200, 150, 0.2);
            }
            75% {
                box-shadow: inset 2px 0 0 rgba(255, 200, 150, 0.6), inset 0 -2px 0 rgba(255, 200, 150, 0.2);
            }
            100% {
                box-shadow: inset 0 2px 0 rgba(255, 200, 150, 0.3);
                opacity: 0;
            }
        }
        .ribbon-trail {
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            pointer-events: none;
            z-index: 5;
            border: 2px solid transparent;
            opacity: 0;
        }

        a.link:hover .ribbon-trail {
            animation: ribbonTrailGlow 1.2s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes ribbonTrailGlow {
            0% {
                border-color: transparent;
                box-shadow: none;
                opacity: 1;
            }
            25% {
                border-top-color: rgba(255, 200, 100, 0.5);
                box-shadow: 0 -2px 10px rgba(255, 200, 100, 0.4);
            }
            50% {
                border-top-color: transparent;
                border-right-color: rgba(255, 200, 100, 0.5);
                box-shadow: 2px 0 10px rgba(255, 200, 100, 0.4);
            }
            75% {
                border-right-color: transparent;
                border-bottom-color: rgba(255, 200, 100, 0.5);
                box-shadow: 0 2px 10px rgba(255, 200, 100, 0.4);
            }
            100% {
                border-bottom-color: transparent;
                border-left-color: rgba(255, 200, 100, 0.3);
                box-shadow: -2px 0 10px rgba(255, 200, 100, 0.2);
                opacity: 0;
            }
        }

        /* Enhanced Hero Title Glitch */
        .hero-title {
            position: relative;
            animation: glitchEnhanced 5s infinite;
        }

        .hero-title::before,
        .hero-title::after {
            content: 'NAJJAK.COM';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            overflow: hidden;
            background: transparent;
            -webkit-text-fill-color: var(--text-main);
        }

        .hero-title::before {
            left: 2px;
            text-shadow: -2px 0 #ff003c;
            animation: glitchEnhanced 3s infinite reverse;
            clip-path: polygon(0 0, 100% 0, 100% 45%, 0 45%);
            opacity: 0.8;
        }

        .hero-title::after {
            left: -2px;
            text-shadow: 2px 0 #00eaff;
            animation: glitchEnhanced 2.5s infinite;
            clip-path: polygon(0 55%, 100% 55%, 100% 100%, 0 100%);
            opacity: 0.8;
        }

        .glitch-line {
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #fff, transparent);
            animation: glitchLine 5s ease-in-out infinite;
            pointer-events: none;
            opacity: 0.5;
        }

        .glitch-noise {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence baseFrequency='0.9'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.1'/%3E%3C/svg%3E");
            animation: glitchNoise 0.5s steps(10) infinite;
            pointer-events: none;
            opacity: 0;
            mix-blend-mode: overlay;
        }

        .hero-title:hover .glitch-noise {
            opacity: 0.3;
        }

        /* 3D Spotlight */
        .spotlight {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -2;
            background: radial-gradient(
                ellipse 600px 400px at var(--spotlight-x, 50%) var(--spotlight-y, 50%),
                rgba(255, 255, 255, 0.025) 0%,
                transparent 70%
            );
            contain: strict;
        }

        /* Ambient Orbs - Floating 3D Elements */
        .ambient-orb {
            position: fixed;
            border-radius: 50%;
            pointer-events: none;
            z-index: -3;
            filter: blur(60px);
            opacity: 0.12;
            animation: ambientDrift 25s ease-in-out infinite;
            contain: layout style;
        }

        .ambient-orb-1 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(255, 0, 60, 0.4) 0%, transparent 70%);
            top: 20%;
            left: -10%;
            animation-delay: 0s;
        }

        .ambient-orb-2 {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(0, 100, 255, 0.3) 0%, transparent 70%);
            top: 60%;
            right: -5%;
            animation-delay: -7s;
            animation-duration: 25s;
        }

        .ambient-orb-3 {
            width: 250px;
            height: 250px;
            background: radial-gradient(circle, rgba(255, 200, 0, 0.2) 0%, transparent 70%);
            bottom: 10%;
            left: 30%;
            animation-delay: -14s;
            animation-duration: 30s;
        }

        /* 3D Grid Floor */
        .grid-floor {
            position: fixed;
            bottom: 0;
            left: -50%;
            width: 200%;
            height: 50vh;
            pointer-events: none;
            z-index: -6;
            background: 
                linear-gradient(to top, rgba(255,255,255,0.02) 0%, transparent 100%),
                repeating-linear-gradient(
                    90deg,
                    transparent 0px,
                    transparent 99px,
                    rgba(255,255,255,0.03) 99px,
                    rgba(255,255,255,0.03) 100px
                ),
                repeating-linear-gradient(
                    0deg,
                    transparent 0px,
                    transparent 99px,
                    rgba(255,255,255,0.03) 99px,
                    rgba(255,255,255,0.03) 100px
                );
            transform: perspective(500px) rotateX(60deg);
            transform-origin: center top;
            opacity: 0.5;
            contain: strict;
        }

        /* Volumetric Light Rays */
        .light-rays {
            position: fixed;
            top: -50%;
            left: 50%;
            width: 100%;
            height: 200%;
            pointer-events: none;
            z-index: -4;
            transform: translateX(-50%);
            background: conic-gradient(
                from 180deg at 50% 0%,
                transparent 0deg,
                rgba(255,255,255,0.015) 10deg,
                transparent 20deg,
                transparent 40deg,
                rgba(255,255,255,0.01) 50deg,
                transparent 60deg,
                transparent 300deg,
                rgba(255,255,255,0.015) 310deg,
                transparent 320deg,
                transparent 360deg
            );
            opacity: 0.7;
            animation: subtleZoom 40s ease-in-out infinite;
            contain: strict;
        }

        /* Film Grain Overlay - Enhanced */
        .film-grain {
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            pointer-events: none;
            z-index: 999;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='1'/%3E%3C/svg%3E");
            opacity: 0.04;
            mix-blend-mode: overlay;
            animation: filmGrain 1s steps(3) infinite;
            contain: strict;
        }

        /* Light Leak Effect */
        .light-leak {
            position: fixed;
            top: 0;
            left: 0;
            width: 150%;
            height: 100%;
            pointer-events: none;
            z-index: 998;
            background: linear-gradient(
                120deg,
                transparent 0%,
                rgba(255, 180, 100, 0.1) 25%,
                rgba(255, 120, 60, 0.06) 45%,
                transparent 65%
            );
            opacity: 0;
            mix-blend-mode: screen;
            animation: lightLeak 15s ease-in-out infinite;
            animation-delay: 3s;
            filter: blur(30px);
            contain: strict;
        }

        /* Anamorphic Lens Flare */
        .lens-flare {
            position: fixed;
            top: 30%;
            left: -20%;
            width: 60%;
            height: 3px;
            pointer-events: none;
            z-index: 997;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(100, 200, 255, 0.8),
                rgba(255, 255, 255, 0.9),
                rgba(100, 200, 255, 0.8),
                transparent
            );
            filter: blur(2px);
            opacity: 0;
            box-shadow: 0 0 30px rgba(100, 200, 255, 0.4);
            contain: strict;
        }

        .lens-flare.active {
            animation: lensFlare 2s ease-out forwards;
        }

        /* Horizontal Scan Line */
        .scan-line {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            pointer-events: none;
            z-index: 996;
            background: linear-gradient(to bottom, 
                transparent,
                rgba(255, 255, 255, 0.02),
                transparent
            );
            animation: horizontalScan 12s linear infinite;
            contain: strict;
        }

        body {
            background-color: #050505;
            color: var(--text-main);
            font-family: 'Cinzel', serif;
            margin: 0;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        /* Depth Layers for Parallax */
        .depth-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -4;
            contain: strict;
        }

        .depth-layer-1 {
            background: radial-gradient(circle at 20% 30%, rgba(255, 0, 60, 0.03) 0%, transparent 50%);
            transform: translateZ(-100px);
        }

        .depth-layer-2 {
            background: radial-gradient(circle at 80% 70%, rgba(0, 150, 255, 0.03) 0%, transparent 50%);
            transform: translateZ(-200px);
        }

        .depth-layer-3 {
            background: radial-gradient(circle at 50% 50%, rgba(255, 200, 100, 0.02) 0%, transparent 60%);
            transform: translateZ(-300px);
        }

        /* Frame Counter - Film Reel Style */
        .frame-counter {
            position: fixed;
            bottom: 80px;
            right: 20px;
            font-family: 'Fira Code', monospace;
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.3);
            z-index: 1002;
            pointer-events: none;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
            letter-spacing: 2px;
        }

        /* Section Particle Burst Container */
        .section-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: visible;
            z-index: 100;
        }

        /* Individual Burst Particle */
        .burst-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0;
        }

        .burst-particle.spark {
            background: #fff;
            box-shadow: 0 0 6px #fff, 0 0 10px rgba(255,200,100,0.8);
        }

        .burst-particle.ember {
            background: #ff6600;
            box-shadow: 0 0 4px #ff6600, 0 0 8px rgba(255,100,0,0.6);
        }

        .burst-particle.dust {
            background: rgba(255,255,255,0.6);
            width: 2px;
            height: 2px;
        }

        @keyframes particleBurstOut {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0);
            }
        }

        @keyframes particleBurstIn {
            0% {
                opacity: 0;
                transform: translate(var(--tx), var(--ty)) scale(0);
            }
            50% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translate(0, 0) scale(1);
            }
        }

        @keyframes particleFadeFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(0.5);
            }
        }

        /* Cinema Mask Corners */
        .cinema-corner {
            position: fixed;
            width: 100px;
            height: 100px;
            pointer-events: none;
            z-index: 1000;
            opacity: 0.3;
        }

        .cinema-corner-tl {
            top: 60px;
            left: 0;
            background: linear-gradient(135deg, rgba(0,0,0,0.5) 0%, transparent 70%);
        }

        .cinema-corner-tr {
            top: 60px;
            right: 0;
            background: linear-gradient(225deg, rgba(0,0,0,0.5) 0%, transparent 70%);
        }

        .cinema-corner-bl {
            bottom: 60px;
            left: 0;
            background: linear-gradient(45deg, rgba(0,0,0,0.5) 0%, transparent 70%);
        }

        .cinema-corner-br {
            bottom: 60px;
            right: 0;
            background: linear-gradient(315deg, rgba(0,0,0,0.5) 0%, transparent 70%);
        }

        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -10;
        }

        #gradient-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -5;
            background: #050505;
            background-image: 
                radial-gradient(circle at 50% 50%, rgba(20, 20, 30, 0.4) 0%, transparent 80%);
        }

        /* Cinematic Vignette - Enhanced */
        .vignette {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            box-shadow: 
                inset 0 0 150px rgba(0, 0, 0, 0.8),
                inset 0 0 300px rgba(0, 0, 0, 0.4);
            transition: box-shadow 0.5s ease;
            contain: strict;
        }

        /* Cinematic Letterbox Bars */
        .letterbox-top, .letterbox-bottom {
            position: fixed;
            left: 0;
            width: 100%;
            height: 60px;
            background: #000;
            z-index: 1001;
            pointer-events: none;
            overflow: hidden;
            transition: height 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .letterbox-top { top: 0; }
        
        .letterbox-bottom {
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Floating Particles - Cinema Dust Motes */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -3;
            overflow: hidden;
            contain: strict;
        }

        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: rgba(255, 150, 80, 0.7);
            border-radius: 50%;
            animation: float-particle linear infinite;
            box-shadow: 0 0 6px rgba(255, 100, 50, 0.4);
            contain: layout style;
        }

        .particle.golden {
            background: rgba(255, 130, 60, 0.8);
            box-shadow: 0 0 8px rgba(255, 100, 30, 0.5);
        }

        .particle.ember {
            background: rgba(255, 90, 40, 0.85);
            box-shadow: 0 0 6px rgba(255, 70, 30, 0.5);
        }

        .particle.bright {
            background: rgba(255, 210, 120, 0.95);
            box-shadow: 0 0 10px rgba(255, 190, 100, 0.5);
        }

        .particle.large {
            width: 6px;
            height: 6px;
            filter: blur(1px);
        }

        /* Ember swirl particle animation - true spiral path */
        @keyframes float-particle {
            0% { 
                transform: translateY(100vh) translateX(calc(var(--swirl-radius, 20px) * 0)) translateZ(0) rotate(0deg) scale(0.5); 
                opacity: 0; 
            }
            5% { 
                opacity: 0.9; 
            }
            100% { 
                transform: translateY(-30vh) translateX(calc(var(--swirl-radius, 20px) * 0)) translateZ(0) rotate(var(--swirl-rotation, 180deg)) scale(0.3); 
                opacity: 0; 
            }
        }

        /* Ember spiral drift animation - smooth continuous spiral using CSS custom properties */
        @keyframes float-particle-drift {
            0% { 
                transform: translateY(100vh) translateX(0) translateZ(0) rotate(0deg) scale(0.4); 
                opacity: 0; 
            }
            5% { 
                opacity: 0.85; 
            }
            100% { 
                transform: translateY(-30vh) translateX(0) translateZ(0) rotate(var(--swirl-rotation, 200deg)) scale(0.3); 
                opacity: 0; 
            }
        }

        /* Particle with parallax data attribute */
        .particle {
            --parallax-speed: 0.5;
            --cursor-x: 0px;
            --cursor-y: 0px;
            transition: margin 0.6s cubic-bezier(0.22, 1, 0.36, 1);
        }

        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='3.5' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.4'/%3E%3C/svg%3E");
            mix-blend-mode: soft-light;
            opacity: 0.4;
        }

        #hero {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            pointer-events: none;
            transform-style: preserve-3d;
            contain: layout style;
        }

        .hero-title {
            font-family: 'Audiowide', cursive;
            font-size: clamp(3rem, 10vw, 6rem);
            color: var(--text-main);
            text-transform: uppercase;
            letter-spacing: 8px;
            margin: 0;
            text-align: center;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            line-height: 1.1;
            padding: 0 20px;
            animation: glitch 5s infinite;
            font-style: italic;
        }

        @keyframes glitch {
            0% { text-shadow: 0 0 20px rgba(255, 255, 255, 0.3); transform: translate(0); }
            2% { text-shadow: 2px 2px 0px #ff003c, -2px -2px 0px #00eaff; transform: translate(-2px, 2px); }
            4% { text-shadow: -2px -2px 0px #ff003c, 2px 2px 0px #00eaff; transform: translate(2px, -2px); }
            6% { text-shadow: 0 0 20px rgba(255, 255, 255, 0.3); transform: translate(0); }
            100% { text-shadow: 0 0 20px rgba(255, 255, 255, 0.3); transform: translate(0); }
        }

        .hero-desc {
            margin: 20px 0 0 0;
            color: #000;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-weight: bold;
            font-size: clamp(0.7rem, 2vw, 1rem);
            text-transform: uppercase;
            letter-spacing: 2px;
            background: linear-gradient(135deg, #ffffff 0%, #cccccc 100%);
            display: inline-block;
            padding: 6px 16px;
            transform: skewX(-20deg);
            box-shadow: 5px 5px 0 rgba(0,0,0,0.5);
        }

        .scroll-indicator {
            font-family: 'Fira Code', monospace;
            font-size: 0.8rem;
            color: var(--text-dim);
            animation: bounce 2s infinite;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 2px;
            white-space: nowrap;
            z-index: 1002;
            padding: 0 12px;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        #content-wrapper {
            padding: 20px 10px;
            /* Push content below the fold */
            margin-top: 100vh; 
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 20;
            transition: filter 0.3s ease;
            pointer-events: auto;
        }

        /* Cinematic color grading overlay */
        #content-wrapper::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            background: linear-gradient(
                180deg,
                rgba(10, 10, 20, 0) 0%,
                rgba(10, 10, 20, 0.1) 50%,
                rgba(10, 10, 20, 0.2) 100%
            );
            mix-blend-mode: color;
            opacity: 0.5;
        }

        /* Removed old header styles */
        /* header { ... } */

        h1 {
            /* Reset h1 styles if used elsewhere, or keep for hero-title override */
            margin: 0;
        }


        main {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            max-width: 500px;
            padding-bottom: calc(20px + var(--footer-safe-area, 0px) + env(safe-area-inset-bottom, 0px));
            pointer-events: auto;
        }

        section {
            position: relative;
            padding: 10px;
            background: transparent;
            opacity: 0; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.6);
            transition: box-shadow 0.5s ease;
            pointer-events: auto;
            contain: layout style;
        }

        /* Chromatic aberration on reveal */
        section.revealing {
            animation: chromaShift 0.5s ease-out;
        }

        /* Cinematic glow when section is in focus */
        section.in-focus {
            box-shadow: 
                0 20px 60px rgba(0,0,0,0.6),
                0 0 80px rgba(255, 0, 60, 0.1),
                0 0 120px rgba(0, 100, 255, 0.05);
        }

        /* Depth blur for sections out of view */
        section.depth-blur {
            filter: blur(2px);
        }

        /* Alternating slide directions */
        section:nth-child(odd) {
            --slide-direction: -60px;
        }
        section:nth-child(even) {
            --slide-direction: 60px;
        }

        /* Staggered section delays for cascade effect */
        section:nth-child(1) { --reveal-delay: 0s; }
        section:nth-child(2) { --reveal-delay: 0.1s; }
        section:nth-child(3) { --reveal-delay: 0.2s; }
        section:nth-child(4) { --reveal-delay: 0.3s; }
        section:nth-child(5) { --reveal-delay: 0.4s; }
        section:nth-child(6) { --reveal-delay: 0.5s; }

        /* Section transition smoothing */
        section.revealed {
            transition: filter 0.5s ease, box-shadow 0.5s ease;
        }

        section.depth-blur {
            opacity: 0.85;
            transition: opacity 0.8s ease;
        }

        section.in-focus {
            opacity: 1;
            transition: opacity 0.3s ease, box-shadow 0.5s ease;
        }

        /* Staggered List Items - Cinematic Cascade */
        section li {
            opacity: 1;
            transform: none;
            transition: none;
            filter: none;
        }

        section.revealed li {
            opacity: 1;
            transform: none;
            filter: none;
        }

        /* Stagger delays for list items - now handled by link animation */

        /* Section header reveal animation - Enhanced */
        section h2 {
            opacity: 0;
            transform: translateY(20px) translateX(-10px);
            transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1), 
                        transform 0.6s cubic-bezier(0.4, 0, 0.2, 1),
                        filter 0.6s ease;
            filter: blur(4px);
        }

        section.revealed h2 {
            opacity: 1;
            transform: translateY(0) translateX(0);
            filter: blur(0);
        }

        /* Section header styling - cursor removed */

        /* Border / Shine Container */
        section::before {
            content: '';
            position: absolute;
            inset: -1px; /* Outset border 1px */
            background: #222; 
            z-index: -2;
            /* Conic gradient: fade in, strong middle, fade out */
            background: conic-gradient(from var(--angle), transparent 0%, #ffffff 10%, #888888 20%, transparent 30%);
            animation: border-rotate 4s linear infinite;
            animation-play-state: paused;
        }

        /* Content Background */
        section::after {
            content: '';
            position: absolute;
            inset: 0; /* Fill the section */
            background: linear-gradient(160deg, #2a2a2a 0%, #111 40%, #050505 100%);
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.1);
            z-index: -1;
        }

        section:hover::before {
            animation-play-state: running;
            box-shadow: none;
        }

        h2 {
            margin: 0 0 5px 0;
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            text-transform: uppercase;
            font-style: normal;
            background: linear-gradient(to bottom, #ffffff, #bbbbbb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            padding: 0;
            display: block;
            text-align: left;
            box-shadow: none;
            /* Removed text-shadow to fix blur on transparent text */
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.3));
            transform: none;
            letter-spacing: 2px;
        }
        
        h2::after { content: none; }

        h3 {
            font-size: 0.65rem;
            background: linear-gradient(to bottom, #ffffff, #bbbbbb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            margin: 10px 0 5px 0;
            letter-spacing: 2px;
            border-bottom: 1px solid #3333;
            padding-bottom: 5px;
            text-align: left;
        }

        ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        li { margin: 0; }

        a.link {
            display: flex;
            flex-wrap: wrap;
            align-items: baseline;
            text-decoration: none;
            color: var(--text-main);
            cursor: pointer;
            pointer-events: auto;
            
            /* Default State */
            background: linear-gradient(to bottom, #222, #111) padding-box;
            border: 1px solid transparent;
            border-left: 4px solid #333;
            
            padding: 6px 10px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275),
                        box-shadow 0.3s ease,
                        border-color 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
            width: 100%;
            box-sizing: border-box;
            /* Avoid 3D transforms on the clickable element itself.
               Some engines/webviews can produce offset hit-testing on transformed anchors. */
            transform: none;
            box-shadow: 
                0 4px 6px rgba(0,0,0,0.5),
                inset 0 1px 0 rgba(255,255,255,0.1);
            /* Individual link animation on scroll */
            opacity: 0;
            --link-slide-dir: -40px;
        }

        /* Alternate slide direction for odd/even links */
        li:nth-child(odd) a.link {
            --link-slide-dir: -40px;
        }
        li:nth-child(even) a.link {
            --link-slide-dir: 40px;
        }

        /* Link reveal animation when section is revealed */
        section.revealed a.link {
            animation: linkRevealSlide 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        /* Staggered animation delays for links */
        section.revealed li:nth-child(1) a.link { animation-delay: 0.1s; }
        section.revealed li:nth-child(2) a.link { animation-delay: 0.18s; }
        section.revealed li:nth-child(3) a.link { animation-delay: 0.26s; }
        section.revealed li:nth-child(4) a.link { animation-delay: 0.34s; }
        section.revealed li:nth-child(5) a.link { animation-delay: 0.42s; }
        section.revealed li:nth-child(6) a.link { animation-delay: 0.50s; }
        section.revealed li:nth-child(7) a.link { animation-delay: 0.58s; }
        section.revealed li:nth-child(8) a.link { animation-delay: 0.66s; }

        /* Activate subtle idle animation when in view */
        section.revealed a.link {
            /* Animation handled by linkRevealSlide */
        }

        /* Stagger idle animation delays - merged with link reveal */

        a.link:hover {
            /* Hover State with Rotating Border */
            background: 
                radial-gradient(80px circle at var(--x) var(--y), rgba(255,255,255,0.15) 0%, transparent 100%) padding-box,
                linear-gradient(to bottom, #252525, #0a0a0a) padding-box,
                radial-gradient(60px circle at var(--x) var(--y), rgba(255,255,255,0.8) 0%, transparent 100%) border-box,
                linear-gradient(to right, #ff6b35 4px, transparent 4px) border-box;
                
            border: 1px solid transparent;
            border-left-width: 4px;
            
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.7),
                0 8px 20px rgba(0,0,0,0.5);
            z-index: 2;
            animation: linkHoverPulse 2s ease-in-out infinite;
        }

        /* Orange glow as pseudo-element so it renders below other links */
        a.link::before {
            content: '';
            position: absolute;
            top: -20px;
            left: -25px;
            right: -20px;
            bottom: -20px;
            background: radial-gradient(ellipse at left center, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.05) 30%, transparent 70%);
            opacity: 0;
            z-index: -1;
            pointer-events: none;
            transition: opacity 0.4s ease;
            filter: blur(15px);
        }

        a.link:hover::before {
            opacity: 1;
        }

        /* 3D Push on hover */
        a.link:hover {
            transform: translateY(-3px) scale(1.02);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275),
                        transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
                        box-shadow 0.4s ease;
        }

        a.link:active {
            transform: translateY(0) scale(0.98) !important;
            background: linear-gradient(to bottom, #0a0a0a, #161616) padding-box;
            box-shadow: 
                0 1px 2px rgba(0,0,0,0.5),
                inset 0 2px 5px rgba(0,0,0,0.5);
            border-top: 1px solid transparent; /* Maintain layout */
            border-left-color: #555;
            transition: all 0.1s ease;
        }

        /* Shine Effect */
        a.link::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 50%;
            height: 100%;
            background: linear-gradient(to right, transparent 0%, rgba(255,255,255,0.1) 50%, transparent 100%);
            transform: skewX(-25deg);
            z-index: 2;
            pointer-events: none;
        }

        a.link:hover::after {
            animation: shine 0.75s ease-in-out;
        }

        a.link .title {
            font-weight: bold;
            font-size: 0.9rem;
            margin-right: auto;
            display: flex;
            align-items: center;
            text-shadow: var(--shadow-x, 1px) var(--shadow-y, 1px) 2px rgba(0,0,0,0.8);
            z-index: 2;
            pointer-events: none;
            transform: translateZ(5px);
            transition: text-shadow 0.1s;
        }

        .favicon {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            vertical-align: middle;
            border-radius: 2px;
            /* filter: grayscale(100%); removed for full color */
            transition: filter 0.2s;
        }
        a.link:hover .favicon {
            /* filter: grayscale(0%); removed */
        }

        a.link .year {
            font-size: 0.65rem;
            color: var(--text-dim);
            opacity: 0.8;
            margin-left: 10px;
            z-index: 2;
            text-shadow: var(--shadow-x, 1px) var(--shadow-y, 1px) 2px rgba(0,0,0,0.8);
            pointer-events: none;
            transform: translateZ(5px);
            transition: text-shadow 0.1s;
        }

        a.link .desc {
            font-size: 0.7rem;
            color: #aaa;
            width: 100%;
            white-space: normal;
            overflow: hidden;
            text-shadow: var(--shadow-x, 1px) var(--shadow-y, 1px) 2px rgba(0,0,0,0.8);
            pointer-events: none;
            line-height: 1.2;
            margin-top: 4px;
            transform: translateZ(2px);
            transition: text-shadow 0.1s;
        }

        /* Removed hover expand animation for desc */
        a.link:hover .desc {
            /* No change needed */
        }

        /* Compact list adjustments */
        .link-list.two-col {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .link-list.tags {
            flex-direction: row;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .link-list.tags li {
            flex: 1 1 auto;
        }

        .link-list.tags .link {
            justify-content: center;
            padding: 8px 12px;
        }

        .link-list.tags .title {
            margin: 0;
            justify-content: center;
            font-size: 0.85rem;
        }
        
        .link-list.tags .favicon {
            margin-right: 6px;
        }

        /* Removed media query for two columns to keep one link per row */

        footer {
            position: relative;
            width: 100%;
            padding: 50px 15px;
            background: transparent;
            color: var(--text-dim);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 5px;
            text-align: center;
            z-index: 1;
            backdrop-filter: blur(12px);
            border-top: 1px solid rgba(255, 200, 150, 0.1);
            pointer-events: none;
            /* Hidden by default */
            opacity: 0;
            transform: none;
            transition: opacity 1s ease;
        }

        footer.visible {
            opacity: 1;
            transform: none;
        }

        footer.visible p {
            animation: footerTextReveal 1.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        }

        footer.visible::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 200, 150, 0.6), rgba(255, 255, 255, 0.8), rgba(255, 200, 150, 0.6), transparent);
            animation: footerLineExpand 1s cubic-bezier(0.22, 1, 0.36, 1) 0.2s forwards;
        }

        @keyframes footerLineExpand {
            0% { width: 0; opacity: 0; }
            50% { opacity: 1; }
            100% { width: 60%; opacity: 0.8; }
        }

        @keyframes footerTextReveal {
            0% { 
                opacity: 0; 
                letter-spacing: 15px;
                filter: blur(4px);
            }
            100% { 
                opacity: 1; 
                letter-spacing: 5px;
                filter: blur(0);
            }
        }

        footer p {
            margin: 0;
            position: relative;
            opacity: 0;
        }

        footer p::before {
            content: ' ';
            opacity: 0.4;
            font-weight: 300;
        }

        footer p::after {
            content: ' ';
            opacity: 0.4;
            font-weight: 300;
        }

        @keyframes footerGlow {
            0%, 100% { 
                text-shadow: 0 0 5px rgba(255, 255, 255, 0.1);
                opacity: 0.6;
            }
            50% { 
                text-shadow: 0 0 15px rgba(255, 255, 255, 0.3), 0 0 30px rgba(100, 200, 255, 0.1);
                opacity: 1;
            }
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            background: var(--bg-dark);
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        /* Title SVG Styles */
        #title {
            width: 100%;
            max-width: 800px;
            margin: 0 auto 20px auto;
            position: relative;
            transform: skew(0deg); /* Reset skew from old design if needed, or keep it */
        }

        .text {
            fill: none;
            stroke-width: 1;
            stroke-linejoin: bevel;
            stroke-dasharray: 100 300;
            stroke-dashoffset: 0;
            animation: stroke 10s infinite cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-family: 'Audiowide', 'Cinzel', sans-serif;
            font-size: 120px;
            font-weight: bold;
        }

        .text:nth-child(5n + 1) {
            stroke: #0AF;
            filter: drop-shadow(0 0 8px #0AF);
            animation-delay: -1.0s;
        }

        .text:nth-child(5n + 2) {
            stroke: #0F0;
            filter: drop-shadow(0 0 8px #0F0);
            animation-delay: -2.0s;
        }

        .text:nth-child(5n + 3) {
            stroke: #FF0;
            filter: drop-shadow(0 0 8px #FF0);
            animation-delay: -3.0s;
        }

        .text:nth-child(5n + 4) {
            stroke: #F0F;
            filter: drop-shadow(0 0 8px #F0F);
            animation-delay: -4.0s;
        }

        .text:nth-child(5n + 5) {
            stroke: #F00;
            filter: drop-shadow(0 0 8px #F00);
            animation-delay: -5s;
        }

        @keyframes stroke {
            100% {
                stroke-dashoffset: -400;
            }
        }
        
        /* Music Section Styles */
        .albumCover {
            width: 48px;
            height: 48px;
            border-radius: 4px;
            margin-right: 10px;
            object-fit: cover;
        }
        
        #music-details {
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow: hidden;
        }
        
        #music-artist {
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--text-main);
        }
        
        #music-track {
            font-size: 0.75rem;
            color: var(--text-dim);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .music-content {
            display: flex;
            align-items: center;
            width: 100%;
        }

        /* ========== MOBILE OPTIMIZATIONS ========== */
        @media (max-width: 768px) {
            /* Hide only non-essential heavy visual effects on mobile */
            .depth-layer,
            .cinema-corner,
            .frame-counter {
                display: none !important;
            }
            
            /* Simplified vignette */
            .vignette {
                box-shadow: inset 0 0 80px rgba(0, 0, 0, 0.6) !important;
            }
            
            /* Letterbox adjustments */
            .letterbox-top,
            .letterbox-bottom {
                height: 40px !important;
            }
            
            /* Hero section mobile fit */
            #hero {
                padding: 0 15px;
            }
            
            .hero-title {
                font-size: clamp(2rem, 12vw, 3.5rem) !important;
                letter-spacing: 2px !important;
                padding: 0 10px;
            }
            
            /* .hero-title::before/after restored */
            
            .hero-desc {
                font-size: clamp(0.6rem, 2.5vw, 0.85rem) !important;
                padding: 4px 12px;
                transform: skewX(-10deg);
                box-shadow: 3px 3px 0 rgba(0,0,0,0.5);
            }
            
            .scroll-indicator {
                font-size: 0.7rem;
                letter-spacing: 1px;
            }
            
            /* Content wrapper mobile */
            #content-wrapper {
                padding: 15px 10px;
                margin-top: 100vh;
            }
            
            /* Main content mobile */
            main {
                gap: 20px;
                max-width: 100%;
                padding-bottom: calc(30px + env(safe-area-inset-bottom, 0px));
            }
            
            /* Section styling mobile */
            section {
                padding: 12px;
                margin: 0;
                box-shadow: 0 10px 30px rgba(0,0,0,0.5) !important;
            }
            
            /* section::before restored */
            
            /* Headers mobile */
            h2 {
                font-size: 1rem;
                letter-spacing: 1px;
                margin-bottom: 8px;
            }
            
            h3 {
                font-size: 0.6rem;
                margin: 8px 0 4px 0;
            }
            
            /* Links mobile - optimized tap targets */
            ul {
                gap: 6px;
            }
            
            a.link {
                padding: 12px 10px;
                min-height: 44px; /* iOS tap target minimum */
                border-left-width: 3px;
                transform: none !important;
                box-shadow: 0 2px 4px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.08) !important;
            }
            
            a.link:hover,
            a.link:active {
                transform: none !important;
                box-shadow: 0 4px 8px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1) !important;
            }
            
            a.link::before,
            a.link::after {
                display: none !important;
            }
            
            a.link .title {
                font-size: 0.85rem !important;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
            }
            
            a.link .desc {
                font-size: 0.7rem !important;
                margin-top: 2px;
                line-height: 1.3;
            }
            
            a.link .year {
                font-size: 0.6rem !important;
            }
            
            .favicon {
                width: 18px;
                height: 18px;
                margin-right: 6px;
            }
            
            /* Ribbon effects restored */
            
            /* Music section mobile */
            .albumCover {
                width: 40px;
                height: 40px;
            }
            
            #music-artist {
                font-size: 0.8rem;
            }
            
            #music-track {
                font-size: 0.65rem;
            }
            
            /* Footer mobile */
            footer {
                padding: 20px 10px;
                padding-bottom: calc(20px + env(safe-area-inset-bottom, 0px));
                font-size: 0.6rem;
                letter-spacing: 2px;
                backdrop-filter: blur(8px);
            }
            
            /* Scrollbar hidden on mobile */
            ::-webkit-scrollbar {
                display: none;
            }
            
            body {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
        }
        
        /* Extra small devices */
        @media (max-width: 380px) {
            .hero-title {
                font-size: clamp(1.8rem, 14vw, 2.5rem) !important;
                letter-spacing: 1px !important;
            }
            
            .hero-desc {
                font-size: 0.55rem !important;
                padding: 3px 8px;
            }
            
            #content-wrapper {
                padding: 10px 8px;
            }
            
            section {
                padding: 10px;
            }
            
            h2 {
                font-size: 0.9rem;
            }
            
            a.link {
                padding: 10px 8px;
            }
            
            a.link .title {
                font-size: 0.8rem !important;
            }
            
            a.link .desc {
                font-size: 0.65rem !important;
            }
            
            .favicon {
                width: 16px;
                height: 16px;
            }
        }
        
        /* Landscape mobile */
        @media (max-width: 768px) and (orientation: landscape) {
            #hero {
                height: auto;
                min-height: 100vh;
                padding: 60px 15px;
            }
            
            .hero-title {
                font-size: clamp(1.5rem, 8vw, 2.5rem) !important;
            }
            
            .letterbox-top,
            .letterbox-bottom {
                height: 30px !important;
            }
            
            #content-wrapper {
                margin-top: 100vh;
            }
        }
        
        /* Reduce motion preference */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .film-grain,
            .light-leak,
            .lens-flare,
            .scan-line,
            .particles {
                display: none !important;
            }
        }
        
        /* Touch device optimizations */
        @media (hover: none) and (pointer: coarse) {
            a.link:hover {
                background: linear-gradient(to bottom, #222, #111) padding-box !important;
                border-color: transparent !important;
                transform: none !important;
            }
            
            a.link:active {
                background: linear-gradient(to bottom, #1a1a1a, #0a0a0a) padding-box !important;
                border-left-color: #ff6b35 !important;
            }
            
            /* Disable hover effects that don't work well on touch */
            section:hover::before {
                animation-play-state: paused !important;
            }
        }
        
        /* Safe area insets for notched devices */
        @supports (padding: max(0px)) {
            #content-wrapper {
                padding-left: max(10px, env(safe-area-inset-left));
                padding-right: max(10px, env(safe-area-inset-right));
            }
            
            main {
                padding-bottom: max(30px, calc(env(safe-area-inset-bottom) + 20px));
            }
            
            footer {
                padding-bottom: max(20px, env(safe-area-inset-bottom));
            }
        }
	</style>
</head>
<body>
    <div id="gradient-bg"></div>
    <div class="grid-floor"></div>
    <div class="light-rays"></div>
    <div class="ambient-orb ambient-orb-1"></div>
    <div class="ambient-orb ambient-orb-2"></div>
    <div class="ambient-orb ambient-orb-3"></div>
    <div class="spotlight" id="spotlight"></div>
    <div class="vignette"></div>
    <div class="film-grain"></div>
    <div class="light-leak"></div>
    <div class="lens-flare" id="lens-flare"></div>
    <div class="scan-line"></div>
    <div class="depth-layer depth-layer-1"></div>
    <div class="depth-layer depth-layer-2"></div>
    <div class="depth-layer depth-layer-3"></div>
    <div class="cinema-corner cinema-corner-tl"></div>
    <div class="cinema-corner cinema-corner-tr"></div>
    <div class="cinema-corner cinema-corner-bl"></div>
    <div class="cinema-corner cinema-corner-br"></div>
    <div class="letterbox-top"></div>
    <div class="letterbox-bottom">
        <div class="scroll-indicator" id="scroll-indicator">Scroll to initialize</div>
    </div>
    <div class="particles" id="particles"></div>
    <div class="frame-counter" id="frame-counter">FRAME: 000000</div>
    
    <div id="hero">
        <h1 class="hero-title">
            NAJJAK.COM
            <span class="glitch-line"></span>
            <span class="glitch-noise"></span>
        </h1>
        <p class="hero-desc">Welcome to Martin Petkovski's personal website</p>
    </div>

    <div id="content-wrapper">
        <main>
            <section aria-labelledby="resume-title">
                <ul class="link-list compact">
                    <li>
                        <a class="link" href="resume">
                            <span class="title">Professional resume</span>
                            <span class="year">2017 - present</span>
                            <span class="desc">Mostly engineering stuff in 3D space.</span>
                        </a>
                    </li>
                </ul>
            </section>

            <section aria-labelledby="powered-title">
                <h2 id="powered-title">My code has powered</h2>
                <ul class="link-list compact">
                    <li>
                        <a class="link" href="https://kamaikamai.com">
                            <span class="title">Sonder</span>
                            <span class="year">2015</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://www.huntshowdown.com/">
                            <span class="title">Hunt: Showdown</span>
                            <span class="year">2017 - 2018</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://www.youtube.com/watch?v=RahJZCrmUvg">
                            <span class="title">Black Diamond VR</span>
                            <span class="year">2018 - 2019</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://airportbriefing.aero/">
                            <span class="title">Airport Briefing</span>
                            <span class="year">2019 - 2020</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://www.starstable.com/">
                            <span class="title">Star Stable Online</span>
                            <span class="year">2020 - 2022</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://www.angelicthegame.com/">
                            <span class="title">Angelic</span>
                            <span class="year">2020 / 2022 - present</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://store.steampowered.com/app/1682400/The_Strange_Story_Of_Brian_Fisher_Chapter_2/">
                            <span class="title">Strange Story: Chapter 2</span>
                            <span class="year">2023</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://historikal.com/">
                            <span class="title">Historikal</span>
                            <span class="year">2025</span>
                        </a>
                    </li>
                </ul>
            </section>

            <section aria-labelledby="vault-title">
                <h2 id="vault-title">The Vault</h2>
                <h3>Handcrafted</h3>
                <ul class="link-list two-col">
                    <li>
                        <a class="link" href="siotojazz">
                            <span class="title">SIOTO JAZZ</span>
                            <span class="year">2022 - present</span>
                            <span class="desc">Alternative Rock band I'm playing in (guitar).</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="nst">
                            <span class="title">NST: Nonlinear System Tools</span>
                            <span class="year">2021 - 2023</span>
                            <span class="desc">My master's thesis: A tool for writing non-linear interactive narratives.</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://github.com/fiktedu/mkqr">
                            <span class="title">MKQR</span>
                            <span class="year">2021</span>
                            <span class="desc"> An open  standard for financial transactions using QR codes. </span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://github.com/martinpetkovski/ImQuick">
                            <span class="title">ImQuick</span>
                            <span class="year">2021</span>
                            <span class="desc"> A single header ImGui library for separation of interface from logic.</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://www.reddit.com/r/MechanicalKeyboards/comments/vv35cr/gmmk_pro_build_qmk_and_hid_tips_tricks/">
                            <span class="title">Custom QMK Firmwares</span>
                            <span class="year">2022</span>
                            <span class="desc">I did fiddle with custom keyboard firmwares using QMK for a bit.</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="sis/index.html">
                            <span class="title">Sashe Ivanovski Simulator</span>
                            <span class="year">2020</span>
                            <span class="desc">Goofy project, generates swear words in Macedonian.</span>
                        </a>
                    </li>
                </ul>

                <h3>Vibecrafted</h3>
                <ul class="link-list two-col">
                    <li>
                        <a class="link" href="">
                            <span class="title">Automata Suite</span>
                            <span class="year">2025 - present</span>
                            <span class="desc">It's still a secret</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="JustNotepad">
                            <span class="title">Just Notepad</span>
                            <span class="year">2025 - present</span>
                            <span class="desc">Just a Notepad. 3Mb RAM with plugins support.</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="Checkmeg">
                            <span class="title">Checkmeg</span>
                            <span class="year">2020 / 2025 - present</span>
                            <span class="desc">Win32 utility tool for bookmarking literally anything.</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="VSCAdvancedSearch">
                            <span class="title">VSC Advanced Search</span>
                            <span class="year">2025 - present</span>
                            <span class="desc">Advanced search tool for Visual Studio Code.</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="masterlista">
                            <span class="title">Makedonska Muzicka Master Lista</span>
                            <span class="year">2025 - present</span>
                            <span class="desc">Comprehensive music database of Macedonian music.</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="makedonski">
                            <span class="title">Makedonski Leksikon</span>
                            <span class="year">2021 - present</span>
                            <span class="desc">All the words in the Macedonian language and more.</span>
                        </a>
                    </li>
                </ul>
            </section>

            <section aria-labelledby="opinions-title">
                <h2 id="opinions-title">Opinions</h2>
                <ul class="link-list two-col">
                    <li>
                        <a class="link" href="n/?principles">
                            <span class="title">Principles</span>
                            <span class="year">current</span>
                            <span class="desc">Core values and beliefs</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="n/?code-standard-cpp">
                            <span class="title">C++ Code Standard</span>
                            <span class="year">current</span>
                            <span class="desc">Personal coding guidelines and best practices</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="n/?zanaetchiski-raspored">
                            <span class="title">Zanaetchiski Raspored</span>
                            <span class="year">2021</span>
                            <span class="desc">Some thoughts on craftsman vs. manager schedules</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="n/?cyberpunk">
                            <span class="title">Cyberpunk</span>
                            <span class="year">2022</span>
                            <span class="desc">Review of the game</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="n/?nomanssky">
                            <span class="title">No Man's Sky</span>
                            <span class="year">2021</span>
                            <span class="desc">Review of the game</span>
                        </a>
                    </li>
                </ul>
            </section>

            <section aria-labelledby="music-title">
                <h2 id="music-title">Music</h2>
                <ul class="link-list compact">
                    <li>
                        <a class="link" id="musicLink" href="#">
                            <div class="music-content" id="music-listeningnow">
                                <span class="title">Loading...</span>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a class="link" id="musicLinkHr" href="#">
                            <div class="music-content" id="music-heavyrotation">
                                <span class="title">Loading...</span>
                            </div>
                        </a>
                    </li>
                </ul>
            </section>

            <section aria-labelledby="links-title">
                <h2 id="links-title">Links</h2>
                <ul class="link-list two-col">
                    <li>
                        <a class="link" href="https://open.spotify.com/user/31mf67wrbng5tnj4lpgteudoygze">
                            <span class="title">Spotify</span>
                            <span class="year">---</span>
                            <span class="desc">Pesonal profile</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://www.youtube.com/channel/UCcbyTxWAorYwBVSq70vqBqQ/videos">
                            <span class="title">YouTube</span>
                            <span class="year">---</span>
                            <span class="desc">Video goofery</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://github.com/martinpetkovski">
                            <span class="title">GitHub</span>
                            <span class="year">---</span>
                            <span class="desc">Code repositories</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://www.linkedin.com/in/martin-petkovski/">
                            <span class="title">LinkedIn</span>
                            <span class="year">---</span>
                            <span class="desc">Professional network</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://twitter.com/misteriozen">
                            <span class="title">Twitter (misteriozen)</span>
                            <span class="year">---</span>
                            <span class="desc">Personal updates</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://twitter.com/OficialZaev">
                            <span class="title">Twitter (OficialZaev)</span>
                            <span class="year">---</span>
                            <span class="desc">Goofy account</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="https://www.instagram.com/najnajjak/">
                            <span class="title">Instagram (najnajjak)</span>
                            <span class="year">---</span>
                            <span class="desc">Semi-goofy acc</span>
                        </a>
                    </li>
                    <li>
                        <a class="link" href="mailto:martin@najjak.com">
                            <span class="title">Email</span>
                            <span class="year">---</span>
                            <span class="desc">Contact me directly</span>
                        </a>
                    </li>
                </ul>
            </section>
        </main>

        <footer>
            <p>Copyright  Martin Petkovski 2013-2026</p>
        </footer>
    </div>

    <script>
        // Mobile detection and performance optimization
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) 
            || window.innerWidth <= 768 
            || ('ontouchstart' in window);
        const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        const isLowPowerMode = navigator.connection?.saveData || false;
        const shouldReduceEffects = prefersReducedMotion || isLowPowerMode;
        const shouldSimplifyEffects = isMobile;
        
        // Last.fm Fetching - deferred to not block initial render
        requestIdleCallback ? requestIdleCallback(fetchLastFm) : setTimeout(fetchLastFm, 100);
        
        function fetchLastFm() {
        fetch("https://ws.audioscrobbler.com/2.0/", {
            method: "POST",
            body: new URLSearchParams({
                method: "user.getRecentTracks",
                user: "martinpetkovski",
                api_key: "d186251f2ae019335f832db01d96c2f9",
                format: "json"
            })
        })
        .then(response => response.json())
        .then(data => {
            const mostRecentTrack = data.recenttracks.track[0];
            const isPlaying = mostRecentTrack['@attr'] && mostRecentTrack['@attr'].nowplaying === 'true';
            const label = isPlaying ? 'NOW PLAYING' : 'LAST LISTENED';
            
            document.querySelector("#music-listeningnow").innerHTML = `
                <img class="albumCover" src="${mostRecentTrack.image[2]["#text"]}" alt="Album Art"/>
                <div id="music-details">
                    <div style="font-size: 0.65rem; color: var(--accent-3); font-weight: bold;">${label}</div>
                    <div id="music-artist">${mostRecentTrack.artist["#text"]}</div>
                    <div id="music-track">${mostRecentTrack.name}</div>
                </div>
            `;
            document.querySelector("#musicLink").href = mostRecentTrack.url;
        })
        .catch(err => {
            console.error("Last.fm error:", err);
            document.querySelector("#music-listeningnow").innerHTML = '<span class="title">Failed to load music data</span>';
        });

        fetch("https://ws.audioscrobbler.com/2.0/", {
            method: "POST",
            body: new URLSearchParams({
                method: "user.getTopAlbums",
                user: "martinpetkovski",
                api_key: "d186251f2ae019335f832db01d96c2f9",
                period: "1month",
                format: "json"
            })
        })
        .then(response => response.json())
        .then(data => {
            const most_listened_album = data.topalbums.album[0];
            document.querySelector("#music-heavyrotation").innerHTML = `
                <img class="albumCover" src="${most_listened_album.image[2]["#text"]}" alt="Album Art"/>
                <div id="music-details">
                    <div style="font-size: 0.65rem; color: var(--accent-2); font-weight: bold;">HEAVY ROTATION</div>
                    <div id="music-artist">${most_listened_album.artist.name}</div>
                    <div id="music-track">${most_listened_album.name}</div>
                </div>
            `;
            document.querySelector("#musicLinkHr").href = most_listened_album.url;
        })
        .catch(err => {
            console.error("Last.fm error:", err);
            document.querySelector("#music-heavyrotation").innerHTML = '<span class="title">Failed to load music data</span>';
        });
        } // end fetchLastFm

        // ========== RIBBON WRAP SYSTEM ==========
        // Add ribbon wrap elements to each link (skip on mobile for performance)
        if (!shouldReduceEffects) {
            document.querySelectorAll('a.link').forEach(link => {
                // Add the ribbon wrap overlay (shine effect)
                const ribbonWrap = document.createElement('div');
                ribbonWrap.className = 'ribbon-wrap';
                link.appendChild(ribbonWrap);

                // Add the ribbon particle wrapper
                const ribbonParticleWrap = document.createElement('div');
                ribbonParticleWrap.className = 'ribbon-particle-wrap';
                
                // Add the actual ribbon dot particle
                const ribbonDot = document.createElement('div');
                ribbonDot.className = 'ribbon-dot';
                ribbonParticleWrap.appendChild(ribbonDot);
                
                // Add a trailing dot for cinematic effect
                const ribbonDotTrail = document.createElement('div');
                ribbonDotTrail.className = 'ribbon-dot-trail';
                ribbonParticleWrap.appendChild(ribbonDotTrail);
                
                link.appendChild(ribbonParticleWrap);

                // Add the glow border trace element
                const ribbonGlow = document.createElement('div');
                ribbonGlow.className = 'ribbon-glow';
                link.appendChild(ribbonGlow);
            });
        }

        // Cursor-driven link lighting + tilt (desktop only)
        if (!shouldReduceEffects) {
            document.querySelectorAll('a.link').forEach(link => {
                link.addEventListener('mousemove', (e) => {
                    const rect = link.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;

                    link.style.setProperty('--x', `${x}px`);
                    link.style.setProperty('--y', `${y}px`);

                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;

                    // Tilt
                    const rotateX = ((y - centerY) / centerY) * -12;
                    const rotateY = ((x - centerX) / centerX) * 12;
                    link.style.setProperty('--rotateX', `${rotateX}deg`);
                    link.style.setProperty('--rotateY', `${rotateY}deg`);

                    // Shadow (opposite to cursor)
                    const shadowX = ((x - centerX) / centerX) * -4;
                    const shadowY = ((y - centerY) / centerY) * -4;
                    link.style.setProperty('--shadow-x', `${shadowX}px`);
                    link.style.setProperty('--shadow-y', `${shadowY}px`);
                });

                link.addEventListener('mouseleave', () => {
                    link.style.setProperty('--rotateX', '0deg');
                    link.style.setProperty('--rotateY', '0deg');
                    link.style.setProperty('--shadow-x', '1px');
                    link.style.setProperty('--shadow-y', '1px');
                });
            });
        }
        // ========== END RIBBON WRAP SYSTEM ==========

        // Inject Favicons
        const iconConfig = {
            'instagram': 'https://www.instagram.com',
            'mailto:': '',
            'resume': 'https://www.najjak.com/favicon.ico',
            'siotojazz': 'https://siotojazz.com/truestate/favicon.ico',
            'nst': 'nst/docs/favicon.ico',
            'sis': 'sis/favicon.ico',
            'justnotepad': 'https://www.najjak.com/favicon.ico',
            'checkmeg': 'archive/checkmeg/favicon.ico',
            'masterlista': 'https://www.najjak.com/favicon.ico',
            'makedonski': 'https://www.najjak.com/favicon.ico',
            'principles': 'n/docs/assets/images/favicon.png',
            'code-standard-cpp': 'n/docs/assets/images/favicon.png',
            'zanaetchiski-raspored': 'n/docs/assets/images/favicon.png',
            'eats': 'archive/eats/logo.png',
            'photos': 'photos/thumbnails/DSC00089.JPG',
            'familytree': '',
            'cyberpunk': 'https://www.cyberpunk.net/us/en/',
            'nomanssky': 'https://www.nomanssky.com/',
            'deezer': 'https://deezer.com',
            'spotify': 'https://spotify.com',
            'youtube': 'https://youtube.com',
            'github': 'https://github.com',
            'linkedin': 'https://linkedin.com',
            'twitter': 'https://twitter.com',
        };

        const fallbackIcon = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23555'%3E%3Ccircle cx='12' cy='12' r='4'/%3E%3C/svg%3E";

        document.querySelectorAll('a.link').forEach(link => {
            const href = link.getAttribute('href');
            let iconUrl = null;

            // Check config
            for (const [key, value] of Object.entries(iconConfig)) {
                if (href.toLowerCase().includes(key)) {
                    // Check if it looks like a path or URL (contains / or .)
                    if (value.includes('/') || value.includes('.') || value.startsWith('http')) {
                        if (value.match(/\.(jpeg|jpg|gif|png|svg|ico)$/i)) {
                            iconUrl = value; // Direct image
                        } else {
                            // Website URL - fetch favicon
                            try {
                                const url = new URL(value);
                                iconUrl = `https://www.google.com/s2/favicons?domain=${url.hostname}&sz=32`;
                            } catch (e) {
                                console.warn('Invalid URL in config:', value);
                            }
                        }
                    } else {
                        // It's an emoji/text - convert to SVG data URI
                        const svgString = `<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>${value}</text></svg>`;
                        iconUrl = `data:image/svg+xml,${encodeURIComponent(svgString)}`;
                    }
                    break; // Stop after first match
                }
            }
            
            // If no config match found, and it's an external link, try to fetch favicon from href
            if (!iconUrl && href.startsWith('http')) {
                 try {
                    const url = new URL(href);
                    iconUrl = `https://www.google.com/s2/favicons?domain=${url.hostname}&sz=32`;
                } catch (e) {
                    // Ignore
                }
            }
            
            // Final fallback
            if (!iconUrl) {
                iconUrl = fallbackIcon;
            }
            
            const title = link.querySelector('.title');
            if (title) {
                const img = document.createElement('img');
                img.className = 'favicon';
                img.src = iconUrl;
                img.onerror = () => {
                    if (img.src !== fallbackIcon) {
                        img.src = fallbackIcon;
                    }
                };
                title.prepend(img);
            }
        });

        // Cinematic Scroll & Parallax Engine
        const sections = document.querySelectorAll('section');
        const hero = document.getElementById('hero');
        const sectionData = new Map(); // Store data for each section

        function updateLayout() {
            const scrollY = window.pageYOffset;
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                // Calculate absolute top relative to document
                const absoluteTop = rect.top + scrollY;
                
                sectionData.set(section, {
                    top: absoluteTop,
                    height: rect.height,
                    items: Array.from(section.querySelectorAll('li'))
                });
            });
        }

        // Update layout on load and resize
        window.addEventListener('load', updateLayout);
        window.addEventListener('resize', updateLayout);
        // Update periodically for dynamic content (throttled)
        setTimeout(() => setInterval(updateLayout, 5000), 2000);

        // Smooth Scroll Variables
        let targetScroll = window.pageYOffset;
        let currentScroll = window.pageYOffset;
        const lerpFactor = shouldReduceEffects ? 0.2 : 0.08; // Faster on mobile

        function lerp(start, end, t) {
            return start * (1 - t) + end * t;
        }

        function animateScroll() {
            targetScroll = window.pageYOffset;
            
            // Smooth out the scroll value used for animations (simplified on mobile)
            if (shouldReduceEffects) {
                currentScroll = targetScroll; // No smoothing on mobile for better perf
            } else if (Math.abs(targetScroll - currentScroll) > 0.1) {
                currentScroll = lerp(currentScroll, targetScroll, lerpFactor);
            } else {
                currentScroll = targetScroll;
            }

            const viewportHeight = window.innerHeight;
            const viewportBottom = currentScroll + viewportHeight;

            // Hero Animation - simplified on mobile
            if (hero) {
                let heroProgress = currentScroll / viewportHeight;
                heroProgress = Math.max(0, Math.min(1, heroProgress));
                
                const heroOpacity = 1 - (heroProgress * 1.5);
                
                if (shouldReduceEffects) {
                    // Simplified hero animation for mobile
                    hero.style.opacity = Math.max(0, heroOpacity);
                    hero.style.filter = 'none';
                    hero.style.transform = 'none';
                } else {
                    const heroBlur = heroProgress * 20;
                    const heroRotate = heroProgress * 45;

                    hero.style.opacity = Math.max(0, heroOpacity);
                    
                    if (shouldSimplifyEffects) {
                        hero.style.filter = 'none';
                        hero.style.transform = 'none';
                    } else {
                        hero.style.filter = `blur(${heroBlur}px)`;
                        hero.style.transform = `rotateX(${heroRotate}deg)`;
                    }
                
                    // Title zooms faster and moves up
                    const heroTitle = hero.querySelector('.hero-title');
                    if (heroTitle) {
                        const titleScale = 1 + (heroProgress * 0.8);
                        const titleY = heroProgress * -50;
                        heroTitle.style.transform = `scale(${titleScale}) translateY(${titleY}px)`;
                    }
                
                    // Description zooms slower and moves down slightly
                    const heroDesc = hero.querySelector('.hero-desc');
                    if (heroDesc) {
                        const descScale = 1 + (heroProgress * 0.3);
                        const descY = heroProgress * 30;
                        const descSkew = -20 + (heroProgress * 10);
                        heroDesc.style.transform = `scale(${descScale}) translateY(${descY}px) skewX(${descSkew}deg)`;
                    }
                }
            }

            // Get section index for alternating effects
            let sectionIndex = 0;
            sectionData.forEach((data, section) => {
                const distFromBottom = viewportBottom - data.top;
                
                const start = 0;
                const end = viewportHeight * 0.25;
                
                let progress = (distFromBottom - start) / (end - start);
                progress = Math.max(0, Math.min(1, progress));
                
                // Simplified easing on mobile
                const ease = shouldReduceEffects 
                    ? Math.min(1, progress * 1.5)
                    : progress < 0.5 
                        ? 4 * progress * progress * progress 
                        : 1 - Math.pow(-2 * progress + 2, 3) / 2;

                if (shouldReduceEffects) {
                    // Simplified section animation for mobile
                    section.style.transform = 'none';
                    section.style.opacity = ease;
                } else {
                    // Full animation for desktop
                    const slideX = sectionIndex % 2 === 0 ? -60 : 60;
                    const translateX = (1 - ease) * slideX;
                    const translateY = (1 - ease) * 40;
                    const scale = 0.95 + (ease * 0.05);
                
                    section.style.transform = `translate3d(${translateX}px, ${translateY}px, 0) scale(${scale})`;
                    section.style.opacity = ease;

                    // Drive border highlight by scroll (ties into section::before conic gradient)
                    section.style.setProperty('--angle', `${ease * 360}deg`);

                    // Subtle spotlight glow during reveal
                    const glow = Math.sin(ease * Math.PI);
                    section.style.boxShadow = `0 20px 60px rgba(0,0,0,0.6), 0 0 ${12 * glow}px rgba(255, 0, 60, ${0.15 * glow})`;

                    // Add revealed class for CSS animations (earlier so links appear sooner)
                    if (ease > 0.15) {
                        section.classList.add('revealed');
                    } else {
                        section.classList.remove('revealed');
                    }

                    // Reset transform when fully visible
                    if (ease >= 0.99) {
                        section.style.transform = 'none';
                    }
                }
                
                sectionIndex++;
            });

            // Letterbox Effect - shrinks as you scroll past hero
            const letterboxTop = document.querySelector('.letterbox-top');
            const letterboxBottom = document.querySelector('.letterbox-bottom');
            const scrollIndicator = document.getElementById('scroll-indicator');
            let heroP = Math.min(1, currentScroll / viewportHeight);
            const letterboxHeight = 60 * (1 - heroP);
            if (letterboxTop) letterboxTop.style.height = `${letterboxHeight}px`;
            if (letterboxBottom) letterboxBottom.style.height = `${letterboxHeight}px`;

            // Keep indicator inside the bottom bar and fade it out as the bar collapses
            if (scrollIndicator) {
                const indicatorOpacity = Math.max(0, 1 - heroP * 1.2);
                scrollIndicator.style.opacity = `${indicatorOpacity}`;
            }

            // Vignette intensity based on scroll
            const vignette = document.querySelector('.vignette');
            if (vignette) {
                const vignetteIntensity = 100 + (heroP * 50);
                vignette.style.boxShadow = `inset 0 0 ${vignetteIntensity}px rgba(0, 0, 0, 0.8)`;
            }

            requestAnimationFrame(animateScroll);
        }

        animateScroll();

        // ========== SECTION PARTICLE BURST SYSTEM ==========
        // Skip on mobile for performance
        if (!shouldReduceEffects) {
            // Track section reveal states
            const sectionRevealStates = new Map();
            sections.forEach(section => {
                sectionRevealStates.set(section, { revealed: false, hidden: true });
                
                // Add particle container to each section
                const particleContainer = document.createElement('div');
                particleContainer.className = 'section-particles';
                section.appendChild(particleContainer);
            });

            // Create burst particles
            function createBurstParticles(section, isRevealing) {
                const container = section.querySelector('.section-particles');
                if (!container) return;

                const rect = section.getBoundingClientRect();
                const particleCount = 20 + Math.floor(Math.random() * 15); // Reduced particle count
                const types = ['spark', 'ember', 'dust'];

                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    const type = types[Math.floor(Math.random() * types.length)];
                    particle.className = `burst-particle ${type}`;

                    // Random position along the edges
                    let startX, startY;
                    const edge = Math.floor(Math.random() * 4);
                    
                    if (isRevealing) {
                        // Particles burst inward from edges when revealing
                        switch(edge) {
                            case 0: startX = Math.random() * 100; startY = 0; break; // top
                            case 1: startX = 100; startY = Math.random() * 100; break; // right
                            case 2: startX = Math.random() * 100; startY = 100; break; // bottom
                            case 3: startX = 0; startY = Math.random() * 100; break; // left
                        }
                    } else {
                        // Particles burst outward from center when hiding
                        startX = 40 + Math.random() * 20;
                        startY = 40 + Math.random() * 20;
                    }

                    particle.style.left = `${startX}%`;
                    particle.style.top = `${startY}%`;

                    // Random trajectory - doubled distance
                    const angle = Math.random() * Math.PI * 2;
                    const distance = 100 + Math.random() * 200; // Doubled distance
                    const tx = Math.cos(angle) * distance * (isRevealing ? -0.5 : 1);
                    const ty = Math.sin(angle) * distance * (isRevealing ? -0.5 : 1);

                    particle.style.setProperty('--tx', `${tx}px`);
                    particle.style.setProperty('--ty', `${ty}px`);

                    // Animation - doubled duration
                    const duration = 0.8 + Math.random() * 1.2; // Doubled from 0.4-1.0 to 0.8-2.0
                    const delay = Math.random() * 0.4; // Doubled delay spread
                    
                    particle.style.animation = `${isRevealing ? 'particleBurstIn' : 'particleBurstOut'} ${duration}s ease-out ${delay}s forwards`;

                    container.appendChild(particle);

                    // Clean up after animation
                    setTimeout(() => {
                        particle.remove();
                    }, (duration + delay) * 1000 + 100);
                }
            }

            // Create edge glow particles (continuous during reveal)
            function createEdgeGlowParticles(section) {
                const container = section.querySelector('.section-particles');
                if (!container) return;

                for (let i = 0; i < 5; i++) { // Reduced from 10
                    const particle = document.createElement('div');
                    const types = ['spark', 'dust', 'spark'];
                    particle.className = `burst-particle ${types[Math.floor(Math.random() * types.length)]}`;
                    
                    // Random edge position
                    const edge = Math.floor(Math.random() * 4);
                    let x, y;
                    switch(edge) {
                        case 0: x = Math.random() * 100; y = 0; break;
                        case 1: x = 100; y = Math.random() * 100; break;
                        case 2: x = Math.random() * 100; y = 100; break;
                        case 3: x = 0; y = Math.random() * 100; break;
                    }
                    
                    particle.style.left = `${x}%`;
                    particle.style.top = `${y}%`;
                    particle.style.animation = `particleFadeFloat 2s ease-out forwards`; // Doubled from 1s to 2s
                    
                    container.appendChild(particle);
                    
                    setTimeout(() => particle.remove(), 2000); // Doubled cleanup time
                }
            }

            // Observer for section reveal/hide transitions
            const particleObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const section = entry.target;
                    const state = sectionRevealStates.get(section);
                    
                    if (entry.isIntersecting && entry.intersectionRatio > 0.15) {
                        if (!state.revealed) {
                            state.revealed = true;
                            state.hidden = false;
                            createBurstParticles(section, true);
                        }
                    } else if (!entry.isIntersecting || entry.intersectionRatio < 0.05) {
                        if (state.revealed && !state.hidden) {
                            state.hidden = true;
                            state.revealed = false;
                            createBurstParticles(section, false);
                        }
                    }
                });
            }, { 
                threshold: [0, 0.05, 0.15, 0.3, 0.5],
                rootMargin: '-10% 0px -10% 0px'
            });

            sections.forEach(section => particleObserver.observe(section));

            // Continuous subtle particles on revealed sections - throttled
            let particleIntervalId;
            function startParticleInterval() {
                if (particleIntervalId) return;
                particleIntervalId = setInterval(() => {
                    // Only run if page is visible
                    if (document.hidden) return;
                    sections.forEach(section => {
                        if (section.classList.contains('revealed') && Math.random() > 0.85) {
                            createEdgeGlowParticles(section);
                        }
                    });
                }, 1000);
            }
            document.addEventListener('visibilitychange', () => {
                if (document.hidden && particleIntervalId) {
                    clearInterval(particleIntervalId);
                    particleIntervalId = null;
                } else {
                    startParticleInterval();
                }
            });
            startParticleInterval();
        }

        // ========== END PARTICLE BURST SYSTEM ==========

        // Generate Enhanced CSS Particles (Fire Embers) with spiral motion - desktop only
        const particlesContainer = document.getElementById('particles');
        const allParticles = [];
        
        if (particlesContainer && !shouldReduceEffects) {
            const particleTypes = ['', 'golden', 'ember', 'bright'];
            const particleSizes = ['', 'large'];
            const particleCount = shouldSimplifyEffects ? 15 : 40;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                const type = particleTypes[Math.floor(Math.random() * particleTypes.length)];
                const size = Math.random() > 0.7 ? 'large' : '';
                
                particle.className = `particle ${type} ${size}`.trim();
                
                // Random starting position
                const startX = Math.random() * 100;
                particle.style.left = `${startX}%`;
                
                // Animation timing
                const duration = 15 + Math.random() * 25;
                particle.style.animationDuration = `${duration}s`;
                particle.style.animationDelay = `${Math.random() * 15}s`;
                
                // Size - bigger base sizes
                const baseSize = size === 'large' ? 5 + Math.random() * 5 : 2 + Math.random() * 3;
                particle.style.width = `${baseSize}px`;
                particle.style.height = particle.style.width;
                
                // Spiral parameters - each particle gets unique spiral characteristics
                const swirlRadius = 15 + Math.random() * 35; // How wide the spiral is
                const swirlRotation = 120 + Math.random() * 180; // Total rotation during rise
                const parallaxSpeed = 0.2 + Math.random() * 0.8; // How much it moves on scroll
                const phaseOffset = Math.random() * Math.PI * 2; // Starting phase of spiral
                
                particle.style.setProperty('--swirl-radius', `${swirlRadius}px`);
                particle.style.setProperty('--swirl-rotation', `${swirlRotation}deg`);
                particle.style.setProperty('--parallax-speed', parallaxSpeed);
                
                // Store particle data for parallax scrolling
                allParticles.push({
                    element: particle,
                    baseX: startX,
                    swirlRadius: swirlRadius,
                    parallaxSpeed: parallaxSpeed,
                    phaseOffset: phaseOffset,
                    duration: duration
                });
                
                particlesContainer.appendChild(particle);
            }
        }

        // Parallax scroll effect for particles - desktop only
        let particleScrollY = 0;
        let cursorX = window.innerWidth / 2;
        let cursorY = window.innerHeight / 2;
        let targetCursorX = cursorX;
        let targetCursorY = cursorY;
        
        function updateParticleParallax() {
            if (shouldReduceEffects) return;
            
            const scrollY = window.pageYOffset;
            const scrollDelta = scrollY * 0.1; // Reduce scroll influence
            
            // Smooth cursor interpolation
            cursorX += (targetCursorX - cursorX) * 0.08;
            cursorY += (targetCursorY - cursorY) * 0.08;
            
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            
            allParticles.forEach((p, index) => {
                // Calculate spiral X offset based on scroll position
                const scrollPhase = (scrollY * 0.005 * p.parallaxSpeed) + p.phaseOffset;
                const spiralX = Math.sin(scrollPhase) * p.swirlRadius;
                
                // Parallax Y offset - particles move at different rates
                const parallaxY = scrollY * p.parallaxSpeed * 0.15;
                
                // Cursor repulsion - particles gently push away from cursor
                const rect = p.element.getBoundingClientRect();
                const particleCenterX = rect.left + rect.width / 2;
                const particleCenterY = rect.top + rect.height / 2;
                
                const distX = particleCenterX - cursorX;
                const distY = particleCenterY - cursorY;
                const distance = Math.sqrt(distX * distX + distY * distY);
                
                // Repulsion radius and strength
                const repulsionRadius = 150;
                const maxRepulsion = 40 * p.parallaxSpeed;
                
                let cursorOffsetX = 0;
                let cursorOffsetY = 0;
                
                if (distance < repulsionRadius && distance > 0) {
                    const force = (1 - distance / repulsionRadius) * maxRepulsion;
                    cursorOffsetX = (distX / distance) * force;
                    cursorOffsetY = (distY / distance) * force;
                }
                
                // Apply the spiral + parallax + cursor transform
                p.element.style.setProperty('--scroll-x', `${spiralX}px`);
                p.element.style.marginTop = `${-parallaxY + cursorOffsetY}px`;
                p.element.style.marginLeft = `${spiralX + cursorOffsetX}px`;
            });
            
            particleScrollY = scrollY;
        }
        
        // Track cursor movement - desktop only
        if (!shouldReduceEffects) {
            document.addEventListener('mousemove', (e) => {
                targetCursorX = e.clientX;
                targetCursorY = e.clientY;
            }, { passive: true });
        }
        
        // Particle animation loop for smooth cursor tracking - desktop only
        function animateParticles() {
            if (!shouldReduceEffects) {
                updateParticleParallax();
            }
            requestAnimationFrame(animateParticles);
        }
        if (!shouldReduceEffects) {
            window.addEventListener('scroll', updateParticleParallax, { passive: true });
        }
        animateParticles();

        // Frame Counter Animation - throttled, desktop only
        const frameCounter = document.getElementById('frame-counter');
        let frameCount = 0;
        let lastFrameUpdate = 0;
        
        if (!shouldReduceEffects) {
            function updateFrameCounter(timestamp) {
                // Only update display every 100ms for performance
                if (timestamp - lastFrameUpdate > 100) {
                    frameCount += 6; // Approximate 6 frames per 100ms at 60fps
                    if (frameCounter) {
                        frameCounter.textContent = `FRAME: ${String(frameCount).padStart(6, '0')}`;
                    }
                    lastFrameUpdate = timestamp;
                }
                requestAnimationFrame(updateFrameCounter);
            }
            requestAnimationFrame(updateFrameCounter);
        }

        // Lens Flare on Scroll Milestones - desktop only
        const lensFlare = document.getElementById('lens-flare');
        let lastFlareScroll = 0;
        const flareThreshold = window.innerHeight * 1.5;

        function triggerLensFlare() {
            if (lensFlare && !shouldReduceEffects) {
                lensFlare.classList.remove('active');
                void lensFlare.offsetWidth; // Force reflow
                lensFlare.classList.add('active');
                
                setTimeout(() => {
                    lensFlare.classList.remove('active');
                }, 2000);
            }
        }

        // Depth Layer Parallax - desktop only
        const depthLayers = document.querySelectorAll('.depth-layer');
        
        function updateDepthLayers(scrollY) {
            if (shouldReduceEffects) return;
            depthLayers.forEach((layer, index) => {
                const speed = (index + 1) * 0.1;
                const y = scrollY * speed;
                const scale = 1 + (scrollY * 0.0001 * (index + 1));
                layer.style.transform = `translateY(${y}px) scale(${scale})`;
            });
        }

        // Cinema Corner Fade based on scroll
        const cinemaCorners = document.querySelectorAll('.cinema-corner');
        
        function updateCinemaCorners(progress) {
            cinemaCorners.forEach(corner => {
                corner.style.opacity = Math.max(0.1, 0.5 - progress * 0.4);
            });
        }

        // Enhanced Section Focus Detection
        function updateSectionFocus() {
            const viewportCenter = window.innerHeight / 2;
            let closestSection = null;
            let closestDistance = Infinity;
            
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                const sectionCenter = rect.top + rect.height / 2;
                const distance = Math.abs(sectionCenter - viewportCenter);
                
                if (distance < closestDistance && rect.top < window.innerHeight && rect.bottom > 0) {
                    closestDistance = distance;
                    closestSection = section;
                }
                
                // Depth blur for sections far from center
                if (distance > window.innerHeight * 0.6) {
                    section.classList.add('depth-blur');
                } else {
                    section.classList.remove('depth-blur');
                }
            });
            
            sections.forEach(section => {
                if (section === closestSection) {
                    section.classList.add('in-focus');
                } else {
                    section.classList.remove('in-focus');
                }
            });
        }

        // Chromatic Aberration on Fast Scroll
        let lastScrollY = 0;
        let scrollVelocity = 0;
        const contentWrapper = document.getElementById('content-wrapper');

        function updateScrollEffects() {
            const currentScrollY = window.pageYOffset;
            scrollVelocity = Math.abs(currentScrollY - lastScrollY);
            lastScrollY = currentScrollY;
            
            // Keep wrapper filter off to avoid pointer hitbox glitches on scroll.
            if (contentWrapper) contentWrapper.style.filter = 'none';
            
            // Trigger lens flare at intervals
            if (currentScrollY - lastFlareScroll > flareThreshold) {
                triggerLensFlare();
                lastFlareScroll = currentScrollY;
            }
            
            // Update depth layers
            updateDepthLayers(currentScrollY);
            
            // Update cinema corners
            const heroP = Math.min(1, currentScrollY / window.innerHeight);
            updateCinemaCorners(heroP);
            
            // Update section focus
            updateSectionFocus();
            
            // Background parallax (consolidated from separate listener)
            const gridFloor = document.querySelector('.grid-floor');
            if (gridFloor) {
                gridFloor.style.bottom = `${-currentScrollY * 0.3}px`;
            }
            
            const lightRays = document.querySelector('.light-rays');
            if (lightRays) {
                lightRays.style.top = `${-50 + currentScrollY * 0.015}%`;
            }
        }

        // Hook into scroll animation loop
        const originalAnimateScroll = animateScroll;
        window.addEventListener('scroll', updateScrollEffects, { passive: true });

        // Dramatic Section Reveal with Chromatic Flash
        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !entry.target.classList.contains('was-revealed')) {
                    entry.target.classList.add('revealing');
                    entry.target.classList.add('was-revealed');
                    
                    setTimeout(() => {
                        entry.target.classList.remove('revealing');
                    }, 500);
                }
            });
        }, { threshold: 0.2 });

        sections.forEach(section => revealObserver.observe(section));

        // Mouse-based Light Leak Enhancement - throttled, desktop only
        let lastLightUpdate = 0;
        const lightLeak = document.querySelector('.light-leak');
        const spotlight = document.getElementById('spotlight');
        const ambientOrbs = document.querySelectorAll('.ambient-orb');
        const gridFloorEl = document.querySelector('.grid-floor');
        const lightRaysEl = document.querySelector('.light-rays');
        
        if (!shouldReduceEffects) {
            document.addEventListener('mousemove', (e) => {
                const now = Date.now();
                if (now - lastLightUpdate < 32) return; // ~30fps throttle
                lastLightUpdate = now;
                
                const x = e.clientX / window.innerWidth;
                const y = e.clientY / window.innerHeight;
                
                if (lightLeak) {
                    lightLeak.style.background = `linear-gradient(
                        ${120 + x * 40}deg,
                        transparent 0%,
                        rgba(255, ${150 + y * 50}, ${80 + x * 40}, 0.1) ${20 + x * 20}%,
                        rgba(255, ${80 + y * 40}, ${40 + x * 20}, 0.08) 40%,
                        transparent 60%
                    )`;
                }

                // Update spotlight position
                if (spotlight) {
                    spotlight.style.setProperty('--spotlight-x', `${e.clientX}px`);
                    spotlight.style.setProperty('--spotlight-y', `${e.clientY}px`);
                }

                // Update ambient orbs based on mouse
                ambientOrbs.forEach((orb, index) => {
                    const factor = (index + 1) * 0.02;
                    const offsetX = (e.clientX - window.innerWidth / 2) * factor;
                    const offsetY = (e.clientY - window.innerHeight / 2) * factor;
                    orb.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
                });

                // Update grid floor perspective based on mouse
                if (gridFloorEl) {
                    const rotateY = (x - 0.5) * 10;
                    gridFloorEl.style.transform = `perspective(500px) rotateX(60deg) rotateY(${rotateY}deg)`;
                }

                // Update light rays based on mouse
                if (lightRaysEl) {
                    const offsetX = (x - 0.5) * 20;
                    lightRaysEl.style.transform = `translateX(calc(-50% + ${offsetX}px))`;
                }
            }, { passive: true });
        }

        // (link tilt handled above)

        // Parallax effect for background elements integrated into updateScrollEffects

        // Initial lens flare on page load - desktop only
        if (!shouldReduceEffects) {
            setTimeout(triggerLensFlare, 1000);
        }

        // ========== FOOTER REVEAL SYSTEM ==========
        const footer = document.querySelector('footer');
        let footerRevealed = false;

        function updateFooterSafeArea() {
            if (!footer) return;
            const footerHeight = Math.ceil(footer.getBoundingClientRect().height);
            document.documentElement.style.setProperty('--footer-safe-area', `${footerHeight + 20}px`);
        }

        function checkFooterReveal() {
            if (!footer) return;
            
            const scrollHeight = document.documentElement.scrollHeight;
            const scrollTop = window.pageYOffset;
            const clientHeight = window.innerHeight;
            
            // Check if we're near the bottom (within 100px)
            const nearBottom = scrollTop + clientHeight >= scrollHeight - 100;
            
            // Also check if the last section is mostly visible
            const lastSection = document.querySelector('main > section:last-child');
            let lastSectionVisible = false;
            
            if (lastSection) {
                const rect = lastSection.getBoundingClientRect();
                lastSectionVisible = rect.bottom <= clientHeight + 100;
            }
            
            if ((nearBottom || lastSectionVisible) && !footerRevealed) {
                footerRevealed = true;
                footer.classList.add('visible');
            } else if (!nearBottom && !lastSectionVisible && footerRevealed) {
                footerRevealed = false;
                footer.classList.remove('visible');
            }
        }

        window.addEventListener('scroll', checkFooterReveal, { passive: true });
        window.addEventListener('resize', updateFooterSafeArea, { passive: true });
        updateFooterSafeArea();
        // ========== END FOOTER REVEAL SYSTEM ==========

        // ========== ENHANCED TITLE GLITCH EFFECT ==========
        const heroTitle = document.querySelector('.hero-title');
        
        function triggerIntenseGlitch() {
            if (!heroTitle || shouldReduceEffects) return;
            
            heroTitle.style.animation = 'none';
            heroTitle.offsetHeight; // Force reflow
            heroTitle.style.animation = 'glitchEnhanced 0.5s ease-in-out';
            
            // Reset to normal animation after intense glitch
            setTimeout(() => {
                heroTitle.style.animation = 'glitchEnhanced 5s infinite';
            }, 500);
        }

        // Random intense glitch every 10-18 seconds - visibility aware, desktop only
        if (!shouldReduceEffects) {
            setInterval(() => {
                if (document.hidden) return;
                if (Math.random() > 0.5) {
                    triggerIntenseGlitch();
                }
            }, 10000 + Math.random() * 8000);
        }

        // Glitch on mouse near title - throttled, desktop only
        let lastGlitchCheck = 0;
        if (!shouldReduceEffects) {
            document.addEventListener('mousemove', (e) => {
                const now = Date.now();
                if (now - lastGlitchCheck < 200) return; // Throttle to 5 checks/second
                lastGlitchCheck = now;
                
                if (!heroTitle) return;
                const rect = heroTitle.getBoundingClientRect();
                const distance = Math.sqrt(
                    Math.pow(e.clientX - (rect.left + rect.width / 2), 2) +
                    Math.pow(e.clientY - (rect.top + rect.height / 2), 2)
                );
                
                if (distance < 200 && Math.random() > 0.97) {
                    triggerIntenseGlitch();
                }
            }, { passive: true });
        }
        // ========== END ENHANCED TITLE GLITCH ==========

        // Periodic subtle effects - throttled and visibility aware, desktop only
        if (!shouldReduceEffects) {
            let flickerIntervalId = setInterval(() => {
                if (document.hidden) return;
                // Random flicker for cinematic effect
                const grain = document.querySelector('.film-grain');
                if (grain && Math.random() > 0.97) {
                    grain.style.opacity = '0.1';
                    setTimeout(() => { grain.style.opacity = '0.04'; }, 50);
                }
            }, 200);
        }
    </script>
</body>

</html>
