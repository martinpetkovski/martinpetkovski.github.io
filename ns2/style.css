    :root {
        --ns2-logo-font: 'NS2 Logo', 'Orbitron', 'Noto Sans JP', sans-serif;
    }

    @font-face {
        font-family: 'NS2 Logo';
        src: url('fonts/Orbitron-latin.woff2') format('woff2');
        font-style: normal;
        font-weight: 900;
        font-display: swap;
    }

    body {
        font-family: 'Noto Sans JP', sans-serif;
        margin: 0;
        padding: 0;
        background-color: #1E1E1E;
        color: #D4D4D4;
        font-size: 13px;
        height: 100vh;
        box-shadow: inset 0 0 50px rgba(0,0,0,0.5);
    }

    /* Disable text selection by default across the UI; re-enable only for
       form controls and the Monaco editor so users can select code and form text */
    * {
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }
    input, textarea, select, option, button {
        -webkit-user-select: text;
        -moz-user-select: text;
        -ms-user-select: text;
        user-select: text;
    }
    [contenteditable], .monaco-editor, .monaco-editor * {
        -webkit-user-select: text !important;
        -moz-user-select: text !important;
        -ms-user-select: text !important;
        user-select: text !important;
    }

    #splash-screen {
        position: fixed;
        inset: 0;
        background-color: #0C0C0C;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        transition: opacity 0.08s ease-out;
    }
    #splash-screen img {
        height: 140px;
        width: auto;
        filter: drop-shadow(0 0 30px #00AbC0);
        animation: pulse 1.5s infinite alternate;
    }
    #splash-screen h1 {
        font-family: var(--ns2-logo-font);
        font-size: 26px;
        font-weight: 900;
        letter-spacing: 4px;
        color: #D4D4D4;
        margin: 30px 0 50px;
    }
    #loading-bar-container {
        width: 40%;
        max-width: 500px;
        height: 6px;
        background-color: #2a2a2a;
        overflow: hidden;
    }
    #loading-bar {
        height: 100%;
        width: 0;
        background: linear-gradient(to right, #00ffc0, #00AbC0, #007bb0);
        animation: fill 1s linear forwards;
    }
    @keyframes fill {
        0%   { width: 0%; }
        12%  { width: 8%; }
        25%  { width: 22%; }
        38%  { width: 28%; }
        55%  { width: 58%; }
        70%  { width: 62%; }
        85%  { width: 88%; }
        94%  { width: 94%; }
        100% { width: 100%; }
    }
    @keyframes pulse {
        from { filter: drop-shadow(0 0 20px #00AbC0); }
        to { filter: drop-shadow(0 0 40px #00AbC0); }
    }
    #splash-screen.hidden {
        opacity: 0;
        pointer-events: none;
    }

    .header {
        display: grid;
        grid-template-columns: auto 1fr auto; /* left / center (toolbar) / right (window-controls) */
        align-items: center;
        background: linear-gradient(0deg, #0C0C0C, #1C1C1C);
        padding: 0 10px; /* remove vertical padding from title bar */
        border-bottom: 1px solid #2a2a2a;
        position: sticky;
        top: 0;
        z-index: 100;
        gap: 10px;
        min-height: 34px; /* previous header height — restore to previous look */
        height: auto;
        flex-shrink: 0;
        box-sizing: border-box;
        box-shadow: 0 4px 12px rgba(0,0,0,0.4), 0 2px 0 rgba(255,255,255,0.05);
    }
    /* Make header draggable in frameless Electron; interactive controls must opt-out with no-drag */
    .header { -webkit-app-region: drag; }
    .no-drag { -webkit-app-region: no-drag; }
    /* Ensure interactive controls are clickable inside draggable header */
    .icon-button, .menu-button, button, a, input, select, textarea { -webkit-app-region: no-drag; }

    /* Layout helpers for the three header columns when using CSS grid */
    .header-left { display:flex; align-items:center; gap:8px; min-width:0; }
    .header-center { display:flex; align-items:center; gap:8px; flex-wrap:wrap; min-width:0; }
    .header-right { display:flex; align-items:center; gap:6px; justify-self:end; flex:0 0 auto; }

    /* remove the forced small title-line rule so compact header rules take effect */

    /* Ensure toolbar group labels are explicitly non-selectable */
    .toolbar-group .group-label,
    .toolbar .group-label {
        -webkit-user-select: none !important;
        -moz-user-select: none !important;
        -ms-user-select: none !important;
        user-select: none !important;
    }

    h1 {
        font-size: 20px;
        color: #D4D4D4;
        font-weight: 900;
        font-family: var(--ns2-logo-font);
        letter-spacing: 1px;
        margin: 0;
        text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }

    /* UNIFORM BUTTON STYLING */
    button {
        padding: 5px 8px;
        background: linear-gradient(0deg, #111, #222 );
        color: #999;
        border-radius: 4px;
        cursor: pointer;
        transition: background 0.3s ease, box-shadow 0.3s ease, transform 0.3s ease, color 0.3s ease;
        display: flex;
        align-items: center;
        gap: 3px;
        font-size: 12px;
        margin: 0;
        border: 1px outset #FFF2;
        font-weight: bold;
    }

    button:hover {
        color: #FFF;
        background: transparent;
        background-color: rgba(0,123,176,0.2);
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6);
    }

    button:active,
    button.active {
        color: #00AbC0;
        border-bottom: 2px solid #00AbC0;
        box-shadow: inset 16px -5px 20px rgba(0,123,176,0.6);
        background-color: rgba(0,123,176,0.2) !important;
        background: rgba(0,123,176,0.2) !important;
    }

    .tab-button.active {
        background-color: rgba(0,123,176,0.4);
    }

    input[type="file"] {
        padding: 5px;
        font-size: 12px;
        background-color: #2D2D2D;
        color: #D4D4D4;
        border: 1px solid #3C3C3C;
        border-radius: 3px;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.05);
    }

    input[type="file"]::file-selector-button {
        background: none;
        color: #999;
        border: none;
        padding: 5px 8px;
        border-radius: 0;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: inset 0 -2px 0 rgba(255,255,255,0.05);
        border-bottom: 2px solid transparent;
        font-weight: bold;
    }

    input[type="file"]::file-selector-button:hover {
        color: #00AbC0;
        background: linear-gradient(0deg,rgba(15, 15, 15, 1) 0%, rgba(25, 25, 25, 1) 100%);
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6);
    }

    .tabs {
        display: flex;
        border-bottom: 1px solid #2a2a2a;
        overflow-x: auto;
        white-space: nowrap;
        position: sticky;
        top: 40px;
        z-index: 99;
        background-color: #111;
        background: linear-gradient(0deg,rgba(17, 17, 17, 1) 0%, rgba(30, 30, 30, 1) 100%);
        padding: 0;
        height: 30px;
        flex-shrink: 0;
        box-sizing: border-box;
        box-shadow: 0 4px 12px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.05);
    }

    /* Ensure toolbar is always visible in the header */
    #global-toolbar {
        opacity: 1 !important;
        visibility: visible !important;
        max-height: none !important;
    }

    .tab-button {
        flex: 1;
        min-width: 80px;
        padding: 0 10px;
        height: 100%;
        justify-content: center;
        border: 0 !important;
        border-radius: 0px;
    }

    .tab-content {
        flex: 1;
        flex-direction: column;
        opacity: 0;
        padding: 0;
        box-sizing: border-box;
        position: relative;
        z-index: 1;
        display: none;
        width: 100%;
        box-shadow: inset 0 0 20px rgba(0,0,0,0.3);
    }

    .tab-content.active {
        display: flex;
        opacity: 1;
        z-index: 10;
    }

    #tab-graph {
        padding: 0;
    }

    #tab-graph .toolbar {
        flex-shrink: 0;
        margin-bottom: 0;
        padding: 0;
    }

    #graph-container {
        flex: 1;
        position: relative;
        background-color: #252526;
        box-shadow: 0 6px 16px rgba(0,0,0,0.5), inset 0 2px 4px rgba(0,0,0,0.3), inset 0 -2px 0 rgba(255,255,255,0.05);
        transition: all 0.5s ease;
        z-index: 1;
        width: 100%;
    }

    #graph-container svg {
        background-color: transparent;
        pointer-events: auto;
        display: block;
        width: 100%;
        height: 100%;
        max-width: none;
        max-height: none;
        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    }

    #tab-graph:not(.active) #graph-container svg {
        pointer-events: none !important;
    }

    .section {
        background-color: #252526;
        box-shadow: 0 6px 16px rgba(0,0,0,0.5), inset 0 2px 0 rgba(255,255,255,0.05), inset 0 -2px 0 rgba(0,0,0,0.3);
        padding: 8px;
        transition: all 0.3s ease;
    }

    .section:hover {
        box-shadow: 0 8px 20px rgba(0,0,0,0.6), inset 0 3px 0 rgba(255,255,255,0.1), inset 0 -3px 0 rgba(0,0,0,0.4);
    }

    details {
        margin-bottom: 8px;
        transition: all 0.3s ease;
    }

    summary {
        cursor: pointer;
        font-weight: 500;
        padding: 5px;
        background-color: #2D2D2D;
        border-radius: 3px;
        color: #D4D4D4;
        list-style: none;
        transition: all 0.3s;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1), inset 0 -1px 0 rgba(0,0,0,0.2);
    }

    summary:hover {
        background-color: #3C3C3D;
        box-shadow: 0 6px 12px rgba(0,0,0,0.4), inset 0 2px 0 rgba(255,255,255,0.15), inset 0 -2px 0 rgba(0,0,0,0.3);
    }

    details[open] summary ~ * {
        animation: fadeIn 0.5s ease-in-out;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 16px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.05);
        border: inset 1px #333;
    }

    th, td {
        padding: 5px;
        text-align: left;
        border-bottom: 1px solid #3C3C3C;
        transition: all 0.3s;
        vertical-align: middle;
        height: auto;
    }

    th {
        background-color: #2D2D2D;
        font-weight: 500;
        color: #D4D4D4;
        box-shadow: inset 0 2px 0 rgba(255,255,255,0.05), inset 0 -1px 0 rgba(0,0,0,0.2);
        text-align: center;
    }

    tr:hover td {
        background-color: #2D2D2D;
        box-shadow: inset 0 1px 0 rgba(255,255,255,0.05);
    }

    input, textarea, select {
        width: 100%;
        box-sizing: border-box;
        padding: 5px;
        border: 1px inset #3C3C3C;
        border-radius: 0;
        font-size: 12px;
        background-color: #1E1E1E;
        color: #D4D4D4;
        font-family: 'Consolas', 'Monaco', monospace;
        box-shadow: inset 0 4px 8px rgba(0,0,0,0.3), inset 0 2px 0 rgba(255,255,255,0.05), inset 0 -1px 0 rgba(0,0,0,0.2);
        transition: all 0.3s;
        margin: 0;
    }

    input:focus, textarea:focus, select:focus {
        border: 1px solid #007bb0;
        box-shadow: 0 0 8px rgba(0, 122, 204, 0.6), 0 4px 8px rgba(0,0,0,0.3), inset 0 2px 0 rgba(0,123,176,0.5);
    }

    input[type="checkbox"] {
        width: auto;
        height: 16px;
        accent-color: #007bb0;
        margin-right: 5px;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.2);
    }

    input[type="checkbox"]:hover {
        box-shadow: 0 3px 6px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.3);
    }

    textarea {
        min-height: 40px;
        resize: vertical;
    }

    #story-description {
        min-height: 100px;
    }

    #tab-text {
        font-family: 'Consolas', 'Courier New', monospace;
        background-color: #1E1E1E;
        padding: 8px;
        font-size: 12px;
        line-height: 1.2;
        color: #D4D4D4;
    }

    #text-editor {
        box-shadow: inset 0 2px 4px rgba(0,0,0,0.3), inset 0 -2px 0 rgba(255,255,255,0.05);
        height: 100%;
        width: 100%;
    }

    .flex-row {
        display: flex;
        gap: 8px;
        align-items: center;
    }

    .flex-row button {
        flex-shrink: 0;
    }

    .grid-form {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 8px;
        align-items: center;
    }

    .grid-form label {
        text-align: right;
        font-weight: 500;
        color: #D4D4D4;
        text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }

    #state-search {
        /* Use flexbox sizing so search inputs fill available toolbar space */
        background-color: #1E1E1E;
        color: #D4D4D4;
        border: 1px solid #3C3C3C;
        box-sizing: border-box;
        height: 26px !important;
        padding: 0 8px;
        width: auto;
        flex: 1 1 auto;
        min-width: 0;
    }

    /* Make text inputs inside toolbars expand to fill available area */
    .toolbar input[type="text"], .play-choices-toolbar input[type="text"], .play-vars-toolbar input[type="text"] {
        flex: 1 1 auto;
        min-width: 0;
        width: auto;
        box-sizing: border-box;
        height: 26px !important;
        padding: 0 8px;
        background-color: #1E1E1E;
        color: #D4D4D4;
        border: 1px solid #3C3C3C;
    }

    .target-group {
        display: flex;
        align-items: center;
        gap: 4px;
        width: 100%;
    }

    .target-group input {
        flex: 1;
        width: auto;
        box-sizing: border-box;
        height: 26px !important;
        margin: 0 !important;
    }

    /* Icon buttons - using uniform style similar to tab-buttons */
    .target-group button,
    .icon-button {
        padding: 0;
        font-size: 12px;
        border-radius: 0;
        width: 22px;
        height: 22px;
        justify-content: center;
        color: #999;
        background: linear-gradient(135deg, rgba(0,123,176,0.38) 0%, rgba(0,123,176,0.56) 100%);
        border: none;
        box-shadow: inset 0 -2px 0 rgba(255,255,255,0.05);
        border-bottom: 2px solid transparent;
        transition: background-color 0.22s ease, box-shadow 0.22s ease, color 0.22s ease, transform 0.12s ease;
        cursor: pointer;
    }

    .target-group button:hover,
    .icon-button:hover {
        color: #FFF;
        background: linear-gradient(135deg, rgba(0,123,176,0.6) 0%, rgba(0,123,176,0.8) 100%);
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6);
    }

    /* Restore colored icon buttons inside the toolbar (keeps toolbar background transparent) */
    #global-toolbar .icon-button,
    #global-toolbar .toolbar-group .icon-button {
        padding: 0;
        font-size: 12px;
        border-radius: 0;
        width: 22px;
        height: 22px;
        justify-content: center;
        color: #999;
        background: linear-gradient(135deg, rgba(0,123,176,0.38) 0%, rgba(0,123,176,0.56) 100%);
        border: none;
        box-shadow: inset 0 -2px 0 rgba(255,255,255,0.05);
        border-bottom: 2px solid transparent;
        transition: background-color 0.22s ease, box-shadow 0.22s ease, color 0.22s ease, transform 0.12s ease;
        cursor: pointer;
    }

     /* window controls styling (min/max/close) - keep static inside the header-right column
         so they never overlap toolbar and will not use absolute positioning */
     .window-controls { display:flex; gap:6px; align-items:center; z-index: 120; }
     .window-controls .icon-button { width:28px; height:22px; padding:0; display:flex; align-items:center; justify-content:center; }
     .window-controls .icon-button:hover { background-color: rgba(255,255,255,0.03); color:#fff; }
     .window-controls #win-close:hover { background: linear-gradient(90deg, rgba(220,60,60,0.95), rgba(200,30,30,0.95)); color: #fff; }
     .window-controls { -webkit-app-region: no-drag; flex: 0 0 auto; }

    #global-toolbar .icon-button:hover,
    #global-toolbar .toolbar-group .icon-button:hover {
        color: #FFF;
        background: linear-gradient(135deg, rgba(0,123,176,0.6) 0%, rgba(0,123,176,0.8) 100%);
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6);
    }


    /* Story title displayed in the toolbar */
    .toolbar-story-title {
        color: #FFF5;
        font-size: 16px;
        font-weight: 600;
        margin-right: 8px;
        padding: 2px 6px;
        background: transparent;
        border-radius: 4px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        flex: 1 1 auto;
        min-width: 0; /* allow ellipsis to work inside flex */
        align-self: center;
        font-family: 'Orbitron', sans-serif;
    }

    /* Ultra-thin scrollbars with subtle glow (WebKit/Blink) */
    *::-webkit-scrollbar {
        width: 1px;
        height: 1px;
    }
    *::-webkit-scrollbar-track {
        background: rgba(0,0,0,0); /* transparent track for minimal footprint */
        border: none;
        box-shadow: none;
    }
    *::-webkit-scrollbar-thumb {
        background: rgba(0,170,200,0.85);
        border-radius: 0;
        box-shadow: 0 0 6px rgba(0,170,200,0.45);
        border: none;
    }
    *::-webkit-scrollbar-thumb:hover {
        box-shadow: 0 0 8px rgba(0,170,200,0.65);
    }

    /* Firefox scrollbar support */
    html, body, .section, .tab-content, .states-list-panel, .play-content {
        scrollbar-width: thin; /* Firefox: closest to 1px available */
        scrollbar-color: rgba(0,170,200,0.8) rgba(20,20,24,0.25);
    }

    /* Compact header elements */
    .header h1 { font-size: 15px; margin-left: 6px; line-height: 20px; }
    .header { padding: 0px 8px; }
    button { padding: 3px 5px; font-size: 12px; }
    .toolbar .icon-button { width:20px; height:20px; }

    /* Responsive compaction: reduce spacing and sizes on narrow windows */
    @media (max-width: 1100px) {
        .toolbar { gap: 4px; }
        .toolbar-group { padding: 6px 4px; }
        .toolbar .group-label { display: none; }
        .icon-button, .window-controls .icon-button { width: 20px; height: 20px; }
        .toolbar-story-title { font-size: 12px; padding: 0 6px; }
    }
    @media (max-width: 720px) {
        .header h1 { font-size: 14px; }
        .icon-button { width: 18px; height: 18px; }
        .window-controls .icon-button { width: 22px; }
    }
    /* Base node body */
    .mermaid .node rect,
    .mermaid .node polygon,
    .mermaid .node circle {
        fill: #0f394a; /* deep body color */
        stroke: rgba(0,0,0,0.5);
        stroke-width: 1.5px;
        transition: all 0.18s ease;
        /* Softer, more subtle shadow and an inset hint */
        filter: drop-shadow(0 2px 6px rgba(0,0,0,0.25));
        box-shadow: inset 0 3px 6px rgba(0,0,0,0.12);
        rx: 8; ry: 8;
    }

    /* Hover/active visual similar to UE Blueprint nodes */
    .mermaid .node:hover rect,
    .mermaid .node:hover polygon,
    .mermaid .node:hover circle {
        transform: translateY(-2px) scale(1.01);
        filter: drop-shadow(0 3px 8px rgba(0,0,0,0.28));
        box-shadow: inset 0 4px 8px rgba(0,0,0,0.14);
    }

    /* Node label / title */
    .mermaid .node text {
        fill: #FFFFFF;
        font-weight: 700;
        font-family: 'Segoe UI', Roboto, 'Noto Sans JP', sans-serif;
        font-size: 12px;
        pointer-events: none; /* text shouldn't block pointer events */
        text-shadow: 0 1px 2px rgba(0,0,0,0.6);
    }

    /* Subtle body inset for the label group created by mermaid */
    .mermaid .node .label rect { fill-opacity: 0.02; }
    .mermaid .node .label { pointer-events: none; }

    /* Small pins used as connection ports (we insert these via JS) */
    .mermaid .node .bp-pin { fill: #ffd166; stroke: #ff9f1c; stroke-width: 1px; }
    .mermaid .node .bp-pin.in { fill: #7ed6ff; stroke: #00a3d1; }
    .mermaid .node .bp-pin.out { fill: #ffd166; stroke: #ff9f1c; }

    /* Blueprint-style header band (inserted via JS) */
    .mermaid .node .bp-header,
    svg .node .bp-header,
    .node .bp-header {
        fill: #0b66a1; /* header default */
        stroke: rgba(0,0,0,0.4);
        stroke-width: 1px;
        rx: 6; ry: 6;
        opacity: 1;
    }

    /* When node hovered/selected, brighten header */
    .mermaid .node.graph-hover .bp-header,
    svg .node.graph-hover .bp-header,
    .node.graph-hover .bp-header { fill: #0d78b0; filter: drop-shadow(0 2px 6px rgba(0,0,0,0.18)); }
    .mermaid .node.graph-selected .bp-header,
    svg .node.graph-selected .bp-header,
    .node.graph-selected .bp-header { fill: #007bb0; filter: drop-shadow(0 3px 8px rgba(0,123,176,0.16)); }

    /* Small helper class so inserted foreignObject icons don't steal pointer events */
    .graph-icon-fo { pointer-events: none; }

    /* Highlight & selection visuals */
    .mermaid .node.graph-hover rect,
    .mermaid .node.graph-hover polygon,
    .mermaid .node.graph-hover circle {
        stroke: #ffd166;
        stroke-width: 3px;
        /* subtle highlight shadow (very faint) */
        filter: drop-shadow(0 2px 6px rgba(255,209,102,0.06));
        box-shadow: inset 0 2px 6px rgba(255,209,102,0.03);
    }

    .mermaid .node.graph-selected rect,
    .mermaid .node.graph-selected polygon,
    .mermaid .node.graph-selected circle {
        stroke: #ff8c42;
        stroke-width: 3px;
        filter: drop-shadow(0 3px 8px rgba(255,140,66,0.08));
        transform: translateY(-2px) scale(1.01);
    }

    .graph-icon-fo { pointer-events: none; }

    .mermaid .edgePath .path {
        stroke: #99e6ff;
        stroke-width: 2.5px;
        transition: all 0.18s ease;
        filter: drop-shadow(0 2px 6px rgba(0,0,0,0.35));
        stroke-linecap: round;
    }

    .mermaid .edgeLabel {
        fill: #dff9ff; color: #012a36; background: rgba(255,255,255,0.02);
    }

    .mermaid .edgeLabel {
        background-color: #333333;
        color: #FFFFFF;
        padding: 2px 4px;
        font-size: 11px;
        transition: all 0.3s;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1), inset 0 -1px 0 rgba(0,0,0,0.2);
    }

    .dropdown {
        position: relative;
        width: 100%;
    }

    .dropdown-list {
        position: absolute;
        background: rgba(45,45,45,0.7);
        -webkit-backdrop-filter: blur(6px);
        backdrop-filter: blur(6px);
        border: 1px solid rgba(60,60,60,0.6);
        list-style: none;
        padding: 0;
        margin: 0;
        max-height: 50vh;
        overflow: auto;
        z-index: 1000;
        width: 100%;
        max-width: calc(100vw - 16px);
        display: none;
        box-shadow: 0 8px 22px rgba(0,0,0,0.28);
        transition: opacity 0.12s ease, transform 0.12s ease;
        transform: translateY(-6px);
        opacity: 0;
        border-radius: 0;
    }

    .dropdown-list.visible {
        display: block;
        opacity: 1;
        transform: translateY(0);
    }

    .dropdown-list li {
        padding: 4px 8px;
        cursor: pointer;
        transition: background-color 0.12s ease, color 0.12s ease;
        box-shadow: none;
        color: #e4f3fb;
        font-size: 12px;
    }

    /* Only hover rows that contain child elements (guards against empty/placeholder LIs) */
    .dropdown-list li:has(*):hover {
        color: #00AbC0;
        background: rgba(15,15,15,0.15);
    }

    .toolbar {
        display: flex;
        gap: 8px;
        margin: 0;
        padding: 5px;
        align-items: center;
        background-color: #252526;
        box-shadow: 0 4px 12px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.05), inset 0 -1px 0 rgba(0,0,0,0.2);
    }

    /* Groups inside the global toolbar */
    .toolbar-group {
        display: flex;
        gap: 8px;
        align-items: center;
        padding: 8px 6px;
        border-right: 1px solid rgba(255,255,255,0.03);
        margin-right: 8px;
    }
    /* Practical inline group labels (left of the buttons) with 50% foreground transparency */
    .toolbar-group .group-label {
        display: inline-block;
        margin-right: 6px;
        padding: 0 6px;
        background: transparent;
        border: none;
        border-radius: 8px;
        color: rgba(174,190,205,0.5); /* 50% foreground */
        font-size: 12px;
        font-weight: 600;
        letter-spacing: 0.4px;
        text-transform: uppercase;
        white-space: nowrap;
    }

    .toolbar .menu-button {
        margin-left: auto;
        cursor: pointer !important;
    }

    .play-content {
        background-color: #252526;
        padding: 8px;
        box-shadow: 0 6px 16px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.05);
        flex: 1;
        overflow-y: auto;
    }

    .play-content h2 {
        margin-top: 0;
        font-size: 16px;
        color: #007bb0;
        text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }

    .play-content h3 {
        margin: 16px 0 8px 0;
        font-size: 14px;
        color: #007bb0;
        text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .play-content p {
        margin: 4px 0;
        line-height: 1.4;
    }

    #play-desc {
        max-width: 500px;
        margin-bottom: 20px !important;
        text-align: justify;
    }

    .error {
        color: red;
        text-shadow: 0 1px 2px rgba(255,0,0,0.5);
    }

    .choices {
        display: flex;
        flex-direction: column;
        gap: 4px;
        margin-top: 8px;
        align-self: flex-start;
        width: auto;
    }

    .choices button {
        width: auto;
        min-width: 200px;
        justify-content: flex-start;
        padding: 6px 10px;
        font-size: 13px;
        opacity: 0;
        transform: translateX(-10px);
        animation: slideIn 0.5s forwards;
        text-align: left;
    }

    /* Disabled choice buttons both in editor and play view */
    .choices button[disabled],
    .choices button.disabled {
        opacity: 0.45 !important;
        cursor: not-allowed !important;
        color: #777 !important;
        background-color: rgba(255,255,255,0.02) !important;
        box-shadow: none !important;
        transform: none !important;
        text-decoration: line-through !important;
    }

    /* General disabled button styling for toolbar and other icon buttons */
    button[disabled],
    button.disabled {
        opacity: 0.45 !important;
        cursor: not-allowed !important;
        color: #777 !important;
        box-shadow: none !important;
        background-color: rgba(255,255,255,0.02) !important;
    }

    @keyframes slideIn {
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .states-container {
        display: flex;
        height: 100%;
    }

    .states-list-panel {
        width: 30%;
        border-right: 1px solid #3C3C3C;
        padding: 0;
        overflow-y: auto;
        box-shadow: inset 4px 0 8px rgba(0,0,0,0.3);
        background-color: #151515;
    }

    .states-list-panel ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .states-list-panel ul li {
        padding: 5px;
        cursor: pointer;
        transition: all 0.3s;
        padding-left: 20px;
        border-bottom: 1px solid #222;
        box-shadow: inset 0 2px 12px rgba(0,0,0,0.2);
        color: #999;
    }

    /* Only hover rows that contain child elements (guards against empty/placeholder LIs) */
    .states-list-panel ul li:has(*):hover {
        color: #00AbC0;
        background: linear-gradient(0deg,rgba(15, 15, 15, 1) 0%, rgba(25, 25, 25, 1) 100%);
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6);
    }

    .states-list-panel ul li.selected {
        color: #00AbC0;
        border-bottom: 2px solid #00AbC0;
        box-shadow: inset 16px 0px 20px rgba(0,123,176,0.4);
    }

    .states-list-panel ul li.disabled {
        opacity: 0.85;
        cursor: pointer;
        color: #999;
        text-decoration: none;
        font-style: italic;
    }

    .state-details-panel {
        width: 70%;
        padding: 0;
        overflow-y: auto;
        box-shadow: inset -4px 0 8px rgba(0,0,0,0.3);
        background-color: #252526;
    }

    .menubar {
        display: flex;
        gap: 8px;
        align-items: center;
        margin-left: auto;
        flex: 1 1 auto; /* allow menubar to shrink and wrap */
        flex-wrap: wrap;
        justify-content: flex-end;
    }

    /* toolbar should wrap into its own row when space is limited so it pushes the content below downward */
    .toolbar {
        display: flex;
        gap: 6px;
        align-items: center;
        flex-wrap: nowrap; /* do not wrap toolbar groups; use overflow menu instead */
        flex: 0 0 auto;
        justify-content: flex-end;
        overflow: hidden;
    }

    /* Make toolbar groups wrap as whole units: each .toolbar-group keeps its size and moves to next line if needed */
    .toolbar-group {
        display: inline-flex;
        gap: 6px;
        align-items: center;
        padding: 6px 4px;
        flex: 0 1 auto; /* allow groups to shrink; overflow handled by JS */
        white-space: nowrap; /* prevent internal buttons from wrapping */
        min-width: 0;
    }

    /* ensure the menubar's non-toolbar controls (language/help) stay on the right row */
    .menubar .dropdown-menu { order: 2; }

    .menu-button {
        background-color: #252526;
        padding: 4px 8px;
        position: relative;
        transition: all 0.3s;
        cursor: pointer;
    }

    .dropdown-menu {
        display: none;
        position: absolute;
        background: transparent;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        z-index: 101;
        opacity: 0;
        transform: translateY(-10px) scale(0.95);
        transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        max-height: 200px;
        overflow-y: auto;
        border: 1px solid rgba(60, 60, 60, 0.8);
        text-align: left;
        min-width: 200px;
        width: max-content;
        max-width: 400px;
    }

    .dropdown-menu .menu-button {
        /* subtle bluish toolbar background for visual separation */
        /* slightly stronger blue tint (10% more prominent) */
        background: linear-gradient(180deg, rgba(12,28,48,0.61), rgba(6,16,30,0.66)) !important;
        border: 1px solid rgba(80,140,200,0.066) !important;
    }

    @keyframes dropdownOpen {
        from {
            opacity: 0;
            transform: translateY(-10px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    @keyframes dropdownClose {
        from {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        to {
            opacity: 0;
            transform: translateY(-10px) scale(0.95);
        }
    }

    #language-dropdown {
        max-height: 50vh;
        overflow: hidden;
    }

    #language-dropdown input[type="text"] {
        width: 100%;
        padding: 8px;
        background: #1E1E1E;
        border: none;
        border-bottom: 1px solid #3C3C3C;
        color: #D4D4D4;
        box-sizing: border-box;
        font-size: 12px;
        position: sticky;
        top: 0;
        z-index: 1;
        box-shadow: inset 0 2px 0 rgba(255,255,255,0.05), inset 0 -1px 0 rgba(0,0,0,0.2);
    }

    #language-dropdown .button-container {
        overflow-y: auto;
        max-height: calc(50vh - 40px);
    }

    #language-dropdown button {
        width: 100%;
        text-align: left;
        box-shadow: inset 0 1px 0 rgba(255,255,255,0.05);
    }

    .menu-button:hover .dropdown-menu {
        display: block;
        opacity: 1;
        transform: translateY(0) scale(1);
        animation: dropdownOpen 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    }

    /* Dropdowns styled to match toolbar/tabs (same dark gradient + subtle inner highlight) */
    .dropdown-menu {
        background: linear-gradient(0deg, #111, #222);
        border: 1px solid rgba(255,255,255,0.03);
        box-shadow: 0 8px 20px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
        backdrop-filter: blur(6px);
        color: #D4D4D4;
        border-radius: 0;
        padding: 6px;
    }

    .dropdown-menu button {
        display: flex;
        align-items: center;
        gap: 8px;
        width: 100%;
        text-align: left;
        padding: 8px 10px;
        border: none !important;
        background: transparent !important;
        color: #D4D4D4;
        margin: 2px 0;
        border-radius: 0;
        transition: background-color 0.18s ease, color 0.18s ease, box-shadow 0.18s ease;
    }

    .dropdown-menu button:hover {
        color: #FFF;
        /* Use the same hover visual as toolbar icon buttons for perfect match */
        background: linear-gradient(135deg, rgba(0,123,176,0.6) 0%, rgba(0,123,176,0.8) 100%);
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6);
    }

    /* Inline toolbar styling to match menubar buttons (allow wrapping on small screens) */
    #global-toolbar {
        position: relative;
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap; /* allow groups to wrap to next line on small screens */
        background: transparent;
        padding-left: 6px;
        padding-right: 6px;
        margin-left: 6px;
        pointer-events: auto;
        z-index: 102;
    }

    .dropdown-menu .menu-category {
        padding: 6px 8px;
        border-bottom: 1px solid rgba(255,255,255,0.03);
        align-items: flex-start;
    }

    .dropdown-menu .menu-category-title {
        color: #cfcfcf;
        font-size: 12px;
        padding: 4px 2px 8px 2px;
        font-weight: 600;
        min-width: 120px;
        text-align: left;
        font-family: 'Orbitron', sans-serif;
        letter-spacing: 0.3px;
    }

    /* Category titles should not receive hover highlights */
    .dropdown-menu .menu-category-title,
    .dropdown-menu .menu-category-title * {
        background: transparent !important;
        color: #cfcfcf !important;
        cursor: default !important;
        pointer-events: none; /* ensure title doesn't react to hover/click */
    }

    /* Allow pointer events for search inputs */
    .dropdown-menu .dropdown-search,
    .dropdown-menu .dropdown-search * {
        pointer-events: auto !important;
    }

    /* Ensure the category container itself does not get highlighted when hovering its items */
    .dropdown-menu .menu-category,
    .dropdown-menu .menu-category:hover {
        background: transparent !important;
    }

    /* category layout: title left, items stacked on the right */
    .dropdown-menu .menu-category {
        display: flex;
        gap: 12px;
        align-items: flex-start;
        padding: 6px 8px;
    }

    .dropdown-menu .menu-category-items {
        display: flex;
        flex-direction: column;
        gap: 6px;
        flex: 1 1 auto;
        width: 100%;
        align-items: stretch;
        padding: 0;
    }

    /* Toolbar should be visually transparent (no background) per request */
    #global-toolbar {
        background: transparent !important;
        box-shadow: none !important;
    }

    /* Context menus that are not the small dropdowns (token/graph context)
       — use the same visual language as `.dropdown-menu` so all menus look uniform */
    #context-menu, #graph-context-menu {
        background: linear-gradient(0deg, #111, #222);
        border: 1px solid rgba(255,255,255,0.03);
        box-shadow: 0 8px 20px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
        color: #D4D4D4;
        border-radius: 0;
        padding: 6px;
        max-height: 50vh;
        overflow: auto;
        backdrop-filter: blur(6px);
    }

    #context-menu .dropdown-item, #graph-context-menu .dropdown-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        padding: 8px 10px;
        margin: 4px 0;
        background: transparent;
        color: #D4D4D4;
        border-radius: 0;
        transition: background-color 0.18s ease, box-shadow 0.18s ease;
    }

    #context-menu .dropdown-item:hover, #graph-context-menu .dropdown-item:hover {
        color: #fff;
        /* Use the toolbar button hover gradient to match exact color */
        background: linear-gradient(135deg, rgba(0,123,176,0.6) 0%, rgba(0,123,176,0.8) 100%);
        box-shadow: inset 30px 0 40px rgba(0,123,176,0.6);
    }

    /* Icon tinting: default subtle, teal on hover */
    .dropdown-menu button i,
    .dropdown-menu button .fa,
    #context-menu .dropdown-item i,
    #context-menu .dropdown-item .fa,
    #graph-context-menu .dropdown-item i,
    #graph-context-menu .dropdown-item .fa {
        transition: color 0.18s ease, opacity 0.18s ease;
        color: rgba(212,212,212,0.7);
    }

    .dropdown-menu button:hover i,
    .dropdown-menu button:hover .fa,
    #context-menu .dropdown-item:hover i,
    #context-menu .dropdown-item:hover .fa,
    #graph-context-menu .dropdown-item:hover i,
    #graph-context-menu .dropdown-item:hover .fa {
        color: #00AbC0; /* teal accent */
    }

    .states-list-panel .toolbar {
        position: sticky;
        top: 0;
        background-color: #1E1E1E;
        z-index: 1;
        padding: 5px 5px 5px 0; /* remove left padding so search touches left edge */
        display: flex;
        gap: 8px;
        margin: 0;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.05);
    }

    #tab-variables .toolbar {
        position: sticky;
        top: 0;
        background-color: #1E1E1E;
        z-index: 1;
        padding: 0;
        margin: 0;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.05);
    }

    #file-input, #load-save {
        display: none;
    }

    #tab-graph .toolbar {
        justify-content: flex-start;
    }

    /* Positioning for context menus (kept distinct from small dropdowns) */
    #context-menu {
        position: fixed; /* position relative to viewport for safe clamping */
        z-index: 10000;
        max-height: 50vh; /* responsive to viewport */
        overflow: hidden;
        display: none;
        width: 300px;
        max-width: calc(100vw - 16px);
        transition: opacity 0.12s ease, transform 0.12s ease;
        display: flex;
        flex-direction: column;
        color: #d6e3ea;
        font-size: 12px;
    }

    #context-menu input {
        flex: none;
        position: relative;
        z-index: 1;
        background-color: transparent;
        border-bottom: 1px solid rgba(47,49,51,0.45);
        margin: 0;
        width: calc(100% - 2px);
        box-shadow: none;
        padding: 4px 6px;
        font-size: 12px;
        color: #eaf6ff;
    }

    #context-menu ul {
        flex: 1;
        overflow-y: auto;
        list-style: none;
        padding: 0;
        margin: 0;
    }

    /* Each menu row: fixed first column (token/label), flexible second column (example/description) */
    #context-menu li {
        padding: 3px 6px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: background-color 0.12s ease, color 0.12s ease;
        box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
        color: #cfe7f3;
    }

    /* Token/name column: fixed width to align items in a neat column */
    #context-menu li .token {
        flex: 0 0 100px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        color: #dbefff;
        font-weight: 600;
    }

    /* Example/description column grows to fill remaining space */
    #context-menu li .example {
        flex: 1 1 auto;
        color: rgba(154,166,173,0.45); /* more transparent */
        font-style: normal;
        margin-left: 0;
        overflow: hidden;
        text-overflow: ellipsis;
        font-size: 11px;
        line-height: 1.1;
        text-align: right; /* push description to the right */
    }

    /* Category header rows inside the menu */
    #context-menu li.menu-category {
        padding: 6px 8px;
        font-size: 10px;
        color: rgba(139,153,166,0.9);
        text-transform: uppercase;
        letter-spacing: 0.8px;
        cursor: default;
        box-shadow: none;
    }

    /* Only apply hover to rows that contain child elements (prevents hover on empty/placeholders) */
    #context-menu li:not(.menu-category):has(*):hover {
        color: #00AbC0;
        /* Use toolbar button hover gradient for stronger, consistent highlight */
        background: linear-gradient(135deg, rgba(0,123,176,0.6) 0%, rgba(0,123,176,0.8) 100%);
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6);
    }

    /* Prevent category header rows from highlighting on hover */
    #context-menu li.menu-category:hover {
        background: transparent !important;
        color: rgba(139,153,166,0.9) !important;
        box-shadow: none !important;
    }

    #context-menu li .token {
        flex: 1;
    }

    #context-menu li .example {
        color: rgba(154,166,173,0.5); /* 50% transparent description */
        font-style: normal;
        margin-left: 10px;
        text-align: right; /* ensure description is on the right */
        overflow: hidden;
        text-overflow: ellipsis;
    }

    /* Ensure hidden/placeholder LIs don't receive pointer events (covers inline style cases) */
    .states-list-panel ul li[hidden],
    .states-list-panel ul li[style*="display:none"],
    .states-list-panel ul li[style*="display: none"],
    .dropdown-list li[hidden],
    .dropdown-list li[style*="display:none"],
    .dropdown-list li[style*="display: none"],
    #context-menu li[hidden],
    #context-menu li[style*="display:none"],
    #context-menu li[style*="display: none"] {
        pointer-events: none;
    }

    #context-menu,
    #token-menu-list,
    .dropdown-menu,
    #language-dropdown .button-container,
    #graph-context-menu ul {
        overflow-x: hidden !important;
    }

    .force-visit {
        background-color: #8B0000 !important;
        color: #fff !important;
    }

    .force-visit:hover {
        background-color: #660000 !important;
    }

    /* Graph context menu: use the same visual language as dropdowns for uniformity */
    #graph-context-menu {
        position: fixed;
        z-index: 10000;
        display: none;
        transition: all 0.12s ease;
        min-width: 160px;
        max-width: calc(100vw - 16px);
        max-height: 50vh;
        overflow: auto;
        border-radius: 0;
        /* Visuals matching `.dropdown-menu` */
        background: linear-gradient(0deg, #111, #222);
        border: 1px solid rgba(255,255,255,0.03);
        box-shadow: 0 8px 20px rgba(0,0,0,0.6);
        padding: 6px;
        backdrop-filter: blur(6px);
        -webkit-backdrop-filter: blur(6px);
        color: #D4D4D4;
    }

    #graph-context-menu ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    #graph-context-menu li {
        padding: 6px 8px;
        cursor: pointer;
        transition: background-color 0.18s ease, color 0.18s ease;
        border-radius: 0;
        background: transparent;
        color: #d6e3ea;
    }

    /* Only hover real graph context menu items (skip separators/empty LIs) */
    #graph-context-menu li:has(*):hover {
        color: #FFF;
        background: linear-gradient(135deg, rgba(0,123,176,0.6) 0%, rgba(0,123,176,0.8) 100%);
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6);
    }

    /* Support for dynamic button-based context menu */
    #graph-context-menu .button-container {
        display: flex;
        flex-direction: column;
        gap: 2px;
        padding: 6px;
    }

    #graph-context-menu .button-container button {
        display: flex;
        align-items: center;
        gap: 8px;
        width: 100%;
        text-align: left;
        padding: 8px 10px;
        border: none !important;
        background: transparent !important;
        color: #D4D4D4;
        cursor: pointer;
        transition: background-color 0.18s ease, color 0.18s ease, box-shadow 0.18s ease;
        border-radius: 0;
        font-size: 12px;
    }

    #graph-context-menu .button-container button:hover {
        color: #FFF;
        background: linear-gradient(135deg, rgba(0,123,176,0.6) 0%, rgba(0,123,176,0.8) 100%);
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6);
    }

    #tab-text .toolbar {
        margin: 0;
        padding: 0;
    }

    .choices-section {
        margin-top: 16px;
        flex: 1;
        display: flex;
        flex-direction: column;
    }

    .choices-section .toolbar {
        position: sticky;
        top: 0;
        background-color: #1E1E1E;
        z-index: 1;
        padding: 0;
        margin: 0 0 4px 0;
        flex-shrink: 0;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.05);
    }

    .choices-section .table-wrapper {
        flex: 1;
        overflow-y: auto;
    }

    .choices-section table {
        width: 100%;
        display: table;
    }

    .play-choices-toolbar {
        position: sticky;
        top: 0;
        background-color: #1E1E1E;
        z-index: 1;
        padding: 0;
        margin: 0 0 4px 0;
        flex-shrink: 0;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.05);
    }

    .play-vars-toolbar {
        position: sticky;
        top: 0;
        background-color: #1E1E1E;
        z-index: 1;
        padding: 0;
        margin: 0 0 4px 0;
        flex-shrink: 0;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.05);
    }

    .state-name {
        font-size: 10px;
        color: #FFF4;
        font-style: italic;
        margin-left: 8px;
        text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }

    .flag {
        margin-right: 5px;
        /* prefer OS color emoji fonts so flags render inside Electron */
        font-family: "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", "EmojiOne Color", sans-serif;
        font-size: 16px;
        line-height: 1;
    }
    .flag-img {
        display: inline-block;
        width: 20px;
        height: 14px;
        object-fit: cover;
        margin-right: 6px;
        vertical-align: middle;
    }

    .props-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
    }

    .props-container label {
        position: relative;
        padding: 4px 8px 7px 8px;
        border-bottom: 3px solid transparent;
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
        border-radius: 3px;
        color: #FFF5;
    }

    .props-container label:hover {
        color: #00AbC0;
        background: linear-gradient(0deg,rgba(15, 15, 15, 1) 0%, rgba(25, 25, 25, 1) 100%);
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6);
    }

    .props-container input[type="checkbox"] {
        opacity: 0;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
        z-index: 2;
        margin: 0;
    }

    .props-container label:has(input[type="checkbox"]:checked) {
        border-bottom-color: #00ff00;
        box-shadow: 0 6px 8px rgba(0, 255, 0, 0.3), inset 0 -1px 0 #00ff00;
        color: #00ff00;
        border: 1px #0f0 solid;
        border-bottom-width: 5px;
        background-color: #00ff0011;
    }

    .hide-cell {
        text-align: center;
        padding: 0 5px !important;
    }

    .hide-cell input[type="checkbox"] {
        appearance: none;
        -webkit-appearance: none;
        width: 60px;
        height: 26px;
        background-color: #2D2D2D;
        position: relative;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1);
        transition: background-color 0.3s;
    }

    .hide-cell input[type="checkbox"]:hover {
        background-color: #3C3C3D;
    }

    .hide-cell input[type="checkbox"]::after {
        content: "";
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        bottom: auto;
        left: 8px;
        right: 8px;
        height: 5px;
        background-color: #00000022;
        transition: all 0.3s ease;
    }

    .hide-cell input[type="checkbox"]:checked::after {
        background-color: #0f0;
        box-shadow: 0 0 22px #00ff00;
    }

    html, body { height: 100vh; margin: 0 !important; padding: 0 !important; overflow: hidden; }
    #editor { display: flex; flex-direction: column; height: 100vh; width: 100%; }

    /* Make the global toolbar inline and always visible in the header menubar.
       This neutralizes older fixed/hidden behaviour and lets the header control layout. */
    #global-toolbar {
        position: relative !important;
        top: auto !important;
        left: auto !important;
        transform: none !important;
        z-index: 102 !important;
        background: transparent !important;
        border-radius: 6px;
        opacity: 1 !important;
        visibility: visible !important;
        max-height: none !important;
        overflow: visible !important;
        transition: none !important;
        pointer-events: auto !important;
        width: auto !important;
        max-width: none !important;
        display: flex !important;
        align-items: center !important;
        gap: 6px !important;
        padding: 4px 8px !important;
        margin-right: 6px;
    }

    #tab-metadata .section,
    #tab-variables .section,
    #tab-states .states-container,
    #tab-play .play-content,
    #state-details,
    #graph-container,
    #text-editor { flex: 1; }

    #tab-metadata .section,
    #tab-variables .section,
    #tab-play .play-content,
    #state-details > div { padding: 10px; box-sizing: border-box; }

    .section, table, #graph-container, .play-content, .toolbar,
    .dropdown-menu, #context-menu, #graph-context-menu,
    .state-details-panel, .states-list-panel, .tab-content,
    .menu-button, .dropdown-menu button,
    summary, .props-container label { border-radius: 0 !important; }

    /* Restore rounded visual for menus (this overrides the global zero-radius rule above)
       so dropdowns and context menus remain visually consistent. */
    .dropdown-menu, #context-menu, #graph-context-menu {
        border-radius: 6px !important;
        background: linear-gradient(0deg, #111, #222) !important;
        border: 1px solid rgba(255,255,255,0.03) !important;
        box-shadow: 0 8px 20px rgba(0,0,0,0.6) !important;
        padding: 6px !important;
    }

    .toolbar-group {
        display: flex;
        gap: 8px;
        align-items: center;
        padding: 8px 6px;
        margin-right: 8px;
        flex: 0 1 auto; /* allow groups to shrink and wrap as units */
        min-width: 0;
    }
    /* Contextual toolbar group visual: slightly lighter blue tint and subtle border */
    /* More specific selector: toolbar groups that are contextual should be a bit lighter/more prominent */
    .toolbar-group.toolbar-context {
        background: rgba(120,190,240,0.10); /* ~20% more prominent (lighter) */
        border-radius: 6px;
        padding: 6px 8px;
        border: 1px solid rgba(120,190,240,0.07);
        box-shadow: inset 0 1px 0 rgba(255,255,255,0.03);
    }
    /* vertical separators between categories (30% opacity) */
    .toolbar-group:not(:last-child) {
        border-right: 1px solid rgba(212,212,212,0.1); /* 10% opacity, 1px */
    }
    /* Practical inline group labels (left of the buttons) with 20% foreground transparency and site title font */
    .toolbar-group .group-label {
        order: -1; /* force label to the left of group buttons */
        display: inline-block;
        margin-right: 8px;
        margin-left: 0;
        padding: 0 6px;
        background: transparent;
        border: none;
        border-radius: 8px;
        color: rgba(174,190,205,0.2); /* 20% foreground */
        font-size: 12px;
        font-weight: 600;
        letter-spacing: 0.4px;
        text-transform: uppercase;
        white-space: nowrap;
        font-family: 'Orbitron', sans-serif; /* match site title */
    }

    /* Slight layout tweaks on very small screens */
    @media (max-width: 720px) {
        #global-toolbar { gap: 6px; }
        .toolbar-group { padding: 6px 4px; }
        .toolbar-group .group-label { font-size: 11px; margin-right: 4px; }
    }
    /* Overflow menu for toolbar groups when space is limited */
    .toolbar-overflow { position: relative; }
    .toolbar-overflow .overflow-btn { padding: 6px 8px; }
    .toolbar-overflow .overflow-menu {
        display: none;
        position: absolute;
        top: 100%;
        right: 0;
        background: #1e1e1e;
        border: 1px solid rgba(255,255,255,0.06);
        box-shadow: 0 6px 18px rgba(0,0,0,0.5);
        z-index: 9999;
        min-width: 220px;
        max-height: 360px;
        overflow: auto;
        padding: 6px;
        border-radius: 6px;
    }
    /* Each overflowed group shows its label on top, and buttons flow horizontally beneath */
    .toolbar-overflow .overflow-menu .toolbar-group {
        display: block;
        border-right: none;
        margin: 6px 0;
        padding: 6px 4px;
    }
    .toolbar-overflow .overflow-menu .toolbar-group .group-label {
        display: block;
        margin-bottom: 6px;
        font-size: 12px;
        font-weight: 600;
        color: rgba(174,190,205,0.35);
    }
    .toolbar-overflow .overflow-menu .toolbar-group .icon-button {
        display: inline-flex;
        margin-right: 6px;
        margin-bottom: 4px;
        vertical-align: middle;
    }
    /* Hide the visual separator now that title removed */
    .toolbar-separator { display: none; }

    /* Contextual toolbar groups (states, variables, graph) - visually distinct */
    .toolbar-context-container { display: inline-flex; align-items: center; gap:6px; }
    .toolbar-context { background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.03); border-radius:6px; padding:4px 6px; }
    .choices-section table select {
        height: 26px !important;
        padding: 0 5px !important;
        line-height: 26px !important;
    }
    .hide-cell { 
        display: flex; 
        justify-content: center; 
        align-items: center; 
        padding: 0 5px !important; 
    }

    .hide-cell input[type="checkbox"] {
        height: 26px !important;
        width: 60px !important;
        margin: 0 !important;
    }
    
    /* Status window behaves like a dropdown now (anchored to toolbar).
       Use the shared `.dropdown-menu` visual language and force 50% width. */
    #status-window.dropdown-menu {
        display: none;
        position: fixed; /* will be positioned by `toggleDropdown` */
        width: 50%;
        max-width: 90vw;
        min-width: 320px;
        max-height: 50vh;
        overflow: auto;
        z-index: 110;
    }

    #status-handle {
        cursor: default;
        padding: 8px 10px;
        text-align: left;
        border-bottom: 1px solid rgba(255,255,255,0.03);
        font-weight: 700;
        font-size: 13px;
        background: transparent;
    }

    #play-error {
        padding: 8px 10px;
        font-size: 12px;
        color: #D4D4D4;
        background: transparent;
        border-bottom: 1px solid rgba(255,255,255,0.03);
        white-space: pre-wrap;
        word-wrap: break-word;
        overflow-y: auto;
        max-height: 80px;
    }
    #play-error:empty { display: none; }

    #status-content {
        padding: 8px 10px;
        font-size: 12px;
        color: #D4D4D4;
        background: transparent;
        white-space: pre-wrap;
        word-wrap: break-word;
    }
    /* ------------------------------------------------------------------
       Unified menu styles
       Define a small set of CSS variables and a single rule that applies
       the same visual language to all dropdowns and context menus so
       they look and feel identical (states view context menu is the
       canonical appearance).
       This rule is placed after the other menu rules so it overrides
       duplicate properties and ensures visual consistency.
       ------------------------------------------------------------------ */
    :root {
        /* 50% transparent canonical menu background with blur backdrop */
        --menu-bg: rgba(17,17,17,0.5);
        --menu-border: 1px solid rgba(255,255,255,0.03);
        --menu-shadow: 0 8px 20px rgba(0,0,0,0.6);
        --menu-padding: 6px;
        --menu-radius: 6px;
        --menu-color: #D4D4D4;
        --menu-backdrop: blur(8px);
        --menu-hover-bg: linear-gradient(135deg, rgba(0,123,176,0.6) 0%, rgba(0,123,176,0.8) 100%);
        --menu-hover-icon: #00AbC0;
    }

    /* Apply unified variables to all known menu-like selectors */
    .dropdown-menu,
    #context-menu,
    #graph-context-menu,
    .dropdown-list,
    #token-menu-list,
    #status-window {
        /* Use semi-transparent background and a subtle gradient overlay to match the canonical look */
        background: linear-gradient(0deg, rgba(17,17,17,0.5), rgba(34,34,34,0.5)) !important;
        border: var(--menu-border) !important;
        box-shadow: var(--menu-shadow) !important;
        padding: var(--menu-padding) !important;
        border-radius: var(--menu-radius) !important;
        color: var(--menu-color) !important;
        backdrop-filter: var(--menu-backdrop) !important;
        -webkit-backdrop-filter: var(--menu-backdrop) !important;
    }

    /* Ensure menus are interactive inside draggable header areas in Electron */
    .dropdown-menu,
    #undo-dropdown,
    #language-dropdown,
    #help-dropdown,
    #status-window,
    #graph-context-menu,
    #context-menu {
        -webkit-app-region: no-drag !important;
        pointer-events: auto !important;
    }

    /* Unified hover for real menu items across different menu implementations.
       Exclude category headers and empty/separator list items (they shouldn't highlight). */
    .dropdown-menu button:hover,
    #context-menu li:not(.menu-category):has(*):hover,
    #graph-context-menu li:not(.menu-category):has(*):hover,
    .dropdown-list li:has(*):hover,
    #token-menu-list li:has(*):hover,
    #status-window .button-container button:hover {
        color: #FFF !important;
        background: var(--menu-hover-bg) !important;
        box-shadow: inset 30px 0px 40px rgba(0,123,176,0.6) !important;
    }

    /* Icons in menus adopt the unified hover tint */
    .dropdown-menu button:hover i,
    #context-menu li:not(.menu-category):has(*):hover i,
    #graph-context-menu li:not(.menu-category):has(*):hover i,
    .dropdown-list li:has(*):hover i,
    #token-menu-list li:has(*):hover i {
        color: var(--menu-hover-icon) !important;
    }

    /* Ensure Font Awesome and SVG icons inside menus render correctly and inherit color */
    .dropdown-menu i,
    .dropdown-menu .fa,
    .dropdown-menu .fas,
    #context-menu i,
    #context-menu .fa,
    #context-menu .fas,
    #graph-context-menu i,
    #graph-context-menu .fa,
    #graph-context-menu .fas,
    .dropdown-list i,
    .dropdown-list .fa,
    #token-menu-list i,
    #token-menu-list .fa,
    #status-window i,
    #status-window .fa {
        color: inherit !important;
        opacity: 1 !important;
        filter: none !important;
        font-size: 13px !important;
        line-height: 1 !important;
        display: inline-block !important;
        width: 18px !important;
        text-align: center !important;
    }

    /* Force Font Awesome font family for icons inside menus (solid/regular/brands) */
    .dropdown-menu .fa,
    .dropdown-menu .fas,
    .dropdown-menu .far,
    .dropdown-menu .fab,
    #context-menu .fa,
    #context-menu .fas,
    #context-menu .far,
    #context-menu .fab,
    #graph-context-menu .fa,
    #graph-context-menu .fas,
    #graph-context-menu .far,
    #graph-context-menu .fab {
        font-family: "Font Awesome 6 Free", "Font Awesome 6 Brands", sans-serif !important;
        font-style: normal !important;
        font-variant: normal !important;
        text-rendering: auto !important;
        -webkit-font-smoothing: antialiased !important;
        -moz-osx-font-smoothing: grayscale !important;
    }
    /* Brands use the Brands family and normal weight */
    .fab { font-family: "Font Awesome 6 Brands" !important; font-weight: 400 !important; }
    /* Solid icons require heavier weight */
    .fas { font-weight: 900 !important; }

    /* Pseudo-element rules (Font Awesome uses ::before) */
    .dropdown-menu i::before,
    .dropdown-menu .fa::before,
    #context-menu i::before,
    #context-menu .fa::before,
    #graph-context-menu i::before,
    #graph-context-menu .fa::before {
        color: inherit !important;
        opacity: 1 !important;
    }

    /* Ensure SVG icons fill with currentColor */
    .dropdown-menu svg,
    #context-menu svg,
    #graph-context-menu svg,
    .dropdown-list svg,
    #token-menu-list svg {
        fill: currentColor !important;
        color: inherit !important;
        width: 18px !important;
        height: 18px !important;
    }
    
    /* Ensure internal menu structure (labels, categories, list items) also follow unified style */
    .dropdown-menu *,
    #context-menu *,
    #graph-context-menu *,
    .dropdown-list *,
    #token-menu-list *,
    #status-window * {
        box-sizing: border-box;
        color: var(--menu-color) !important;
        font-family: inherit !important;
    }

    /* Normalize lists inside menus */
    .dropdown-menu ul,
    #context-menu ul,
    #graph-context-menu ul,
    .dropdown-list,
    #token-menu-list,
    #status-window ul {
        list-style: none;
        margin: 0;
        padding: 0;
        overflow: auto;
    }

    /* Generic menu row */
    .dropdown-menu li,
    #context-menu li,
    #graph-context-menu li,
    .dropdown-list li,
    #token-menu-list li,
    #status-window li,
    .dropdown-menu button,
    #status-window .button-container button {
        display: flex !important;
        align-items: center !important;

    /* Explicitly neutralize separators and non-interactive boundary labels so they
       never receive hover styling or pointer events (they are visual only). */
    .menu-separator {
        pointer-events: none !important;
        background: transparent !important;
        color: inherit !important;
    }
        gap: 8px !important;
        width: 100% !important;
        text-align: left !important;
        justify-content: flex-start !important;
        padding: 8px 10px !important;
        background: transparent !important;
        color: var(--menu-color) !important;
        border: none !important;
        border-radius: 4px !important;
        cursor: pointer !important;
        transition: background-color 0.14s ease, color 0.14s ease, box-shadow 0.14s ease;
    }

    /* Ensure buttons and li inside menus accept pointer events (override app-region effects) */
    .dropdown-menu li,
    .dropdown-menu li button,
    .dropdown-menu button,
    #undo-dropdown li,
    #undo-dropdown li button {
        pointer-events: auto !important;
    }

    /* Icon area: fixed small width so text can use rest of the row */
    .dropdown-menu li i,
    .dropdown-menu button i,
    #context-menu li i,
    #graph-context-menu li i {
        flex: 0 0 20px !important;
        width: 20px !important;
        text-align: center !important;
    }

    /* Ensure textual content uses remaining space and is left-aligned */
    .dropdown-menu li span,
    .dropdown-menu button span,
    #context-menu li span,
    #graph-context-menu li span,
    .dropdown-list li span {
        display: block !important;
        text-align: left !important;
    }

    /* Category title / label inside menus (not interactive) */
    .dropdown-menu .menu-category-title,
    .dropdown-menu .menu-category,
    #context-menu li.menu-category,
    #graph-context-menu li.menu-category,
    .dropdown-menu .menu-category-title * {
        font-size: 11px !important;
        color: rgba(207,207,207,0.85) !important;
        text-transform: uppercase !important;
        letter-spacing: 0.6px !important;
        font-weight: 700 !important;
        cursor: default !important;
        pointer-events: none !important;
        background: transparent !important;
        padding: 6px 8px !important;
        margin: 0 !important;
    }
    /* Put category title above items (stacked) so items can take full width.
       Some menu styles elsewhere lay out category title and items side-by-side;
       force a stacked layout for cleaner history dropdowns. */
    .dropdown-menu .menu-category {
        display: block !important;
        width: 100% !important;
    }
    .dropdown-menu .menu-category-title {
        display: block !important;
        width: 100% !important;
        margin-bottom: 8px !important;
        padding: 8px 12px !important;
    }
    .dropdown-menu .menu-category-items {
        display: block !important;
        padding-left: 0 !important;
    }

    /* Prevent category rows from being highlighted like items */
    #context-menu li.menu-category:hover,
    .dropdown-menu .menu-category:hover,
    #graph-context-menu li.menu-category:hover {
        background: transparent !important;
        box-shadow: none !important;
        color: rgba(207,207,207,0.85) !important;
    }

    /* Inputs inside menus (search fields) use the unified look */
    .dropdown-menu input[type="text"],
    #context-menu input[type="text"],
    #graph-context-menu input[type="text"],
    #status-window input[type="text"] {
        background: transparent !important;
        border: 1px solid rgba(255,255,255,0.03) !important;
        border-radius: 4px !important;
        color: var(--menu-color) !important;
        padding: 6px 8px !important;
        width: 100% !important;
        box-shadow: inset 0 1px 0 rgba(255,255,255,0.02) !important;
    }

    /* Disabled / non-interactive items appearance */
    .dropdown-menu button[disabled],
    .dropdown-menu .disabled,
    #context-menu li.disabled,
    #graph-context-menu li.disabled,
    .dropdown-list li.disabled {
        opacity: 0.6 !important;
        cursor: not-allowed !important;
        color: rgba(200,200,200,0.6) !important;
        background: transparent !important;
        box-shadow: none !important;
    }

    /* Ensure icons/text alignment inside token / example rows */
    #context-menu li .token,
    #context-menu li .example,
    #token-menu-list li .token,
    #token-menu-list li .example {
        color: var(--menu-color) !important;
    }

    /* Small safety: keep menu radiuses consistent where other rules tried to remove them */
    .dropdown-menu, #context-menu, #graph-context-menu, .dropdown-list, #token-menu-list, #status-window {
        border-radius: var(--menu-radius) !important;
    }

    /* Force-hide elements when the `hidden` attribute is used. Using `hidden` plus
       an !important rule makes hiding robust against other CSS that may try to
       override inline `display` styles in complex menus. Applies broadly to
       dropdowns, token menus and language/button lists. */
    .dropdown-menu [hidden],
    .dropdown-list [hidden],
    #context-menu [hidden],
    #token-menu-list [hidden],
    #graph-context-menu [hidden] {
        display: none !important;
    }
    /* Also ensure buttons hidden inside language menus and other button-based
       dropdowns are removed from layout (some menus render items as buttons). */
    .button-container button[hidden],
    .dropdown-menu button[hidden] {
        display: none !important;
    }

    .ns2-modal {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 12000;
        font-family: 'Noto Sans JP', sans-serif;
    }
    .ns2-modal.is-visible {
        display: flex;
    }
    .ns2-modal__backdrop {
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at top, rgba(0, 255, 192, 0.12), rgba(0, 0, 0, 0.92));
        backdrop-filter: blur(4px);
    }
    .ns2-modal__panel {
        position: relative;
        width: min(460px, 90vw);
        background: #101318;
        border-radius: 18px;
        border: 1px solid rgba(0, 255, 192, 0.18);
        padding: 32px;
        color: #f2f5f9;
        box-shadow: 0 25px 80px rgba(0, 0, 0, 0.7), inset 0 0 60px rgba(0, 255, 192, 0.08);
    }
    .ns2-modal__close {
        position: absolute;
        top: 14px;
        right: 14px;
        background: transparent;
        border: none;
        color: #8da0b7;
        font-size: 16px;
        cursor: pointer;
        transition: color 0.15s ease;
    }
    .ns2-modal__close:hover { color: #fff; }
    .ns2-modal__icon {
        width: 56px;
        height: 56px;
        border-radius: 14px;
        background: linear-gradient(135deg, #00ffc0, #00a1ff);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: #091013;
        font-size: 24px;
        margin-bottom: 18px;
        box-shadow: 0 0 25px rgba(0, 255, 192, 0.4);
    }
    .ns2-modal__eyebrow {
        text-transform: uppercase;
        font-size: 11px;
        letter-spacing: 4px;
        color: #00ffc0;
        margin-bottom: 8px;
    }
    .ns2-modal__body h2 {
        margin: 0 0 10px;
        font-family: 'Orbitron', sans-serif;
        letter-spacing: 1px;
    }
    .ns2-modal__body p { margin: 0 0 12px; color: #cfd8dc; }
    .ns2-modal__meta {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 12px;
        padding: 12px;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.05);
        margin-bottom: 12px;
    }
    .ns2-modal__meta .label {
        display: block;
        font-size: 11px;
        letter-spacing: 2px;
        text-transform: uppercase;
        color: #8aa0b3;
    }
    .ns2-modal__warning {
        display: flex;
        align-items: center;
        gap: 6px;
        color: #ffb347;
        font-weight: 600;
    }
    .ns2-modal__actions {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-top: 18px;
    }
    .ns2-modal__actions button {
        border: none;
        border-radius: 999px;
        padding: 10px 22px;
        font-size: 13px;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.12s ease, box-shadow 0.12s ease;
    }
    .ns2-modal__actions button.primary {
        background: linear-gradient(135deg, #00ffc0, #00a1ff);
        color: #04090b;
        box-shadow: 0 10px 30px rgba(0, 255, 192, 0.35);
    }
    .ns2-modal__actions button.primary:hover {
        transform: translateY(-1px);
    }
    .ns2-modal__actions button.primary.danger {
        background: linear-gradient(135deg, #c62828, #d32f2f);
        color: #fff;
        box-shadow: 0 10px 30px rgba(198, 40, 40, 0.4);
    }
    .ns2-modal__actions button.primary.danger:hover {
        transform: translateY(-1px);
        box-shadow: 0 12px 34px rgba(198, 40, 40, 0.55);
    }
    .ns2-modal__actions button.ghost {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.25);
        color: #d9e2ed;
    }
    .ns2-modal__actions button.ghost:hover {
        border-color: rgba(255, 255, 255, 0.5);
    }
    .ns2-modal__actions button.ghost.danger {
        border-color: rgba(255, 120, 120, 0.65);
        color: #ffb3b3;
    }
    .ns2-modal__actions button.ghost.danger:hover {
        border-color: rgba(255, 120, 120, 0.95);
        background: rgba(255, 80, 80, 0.15);
        color: #fff;
    }
    .unsaved-pill {
        display: none;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        font-weight: 600;
        letter-spacing: 0.4px;
        text-transform: uppercase;
        color: #f2d191;
        background: rgba(242, 209, 145, 0.16);
        border: 1px solid rgba(242, 209, 145, 0.4);
        border-radius: 999px;
        padding: 2px 8px;
    }
    #recent-dropdown,
    #undo-dropdown {
        width: 320px; /* fixed menu width; JS will position */
        max-width: 90vw;
        max-height: none !important;
        overflow: visible !important;
        padding: 0 !important;
        /* Remove forced left/right auto so JS positioning applies */
        text-align: left;
        -webkit-app-region: no-drag;
    }
    #recent-dropdown *,
    #undo-dropdown * {
        -webkit-app-region: no-drag;
        text-align: left;
    }
    #recent-dropdown .menu-category,
    #undo-dropdown .menu-category {
        display: block !important;
        padding: 0 !important;
        border-bottom: none !important;
        margin: 0;
    }
    #recent-dropdown .menu-category-title,
    #undo-dropdown .menu-category-title {
        padding: 12px 14px 4px !important;
        border-bottom: 1px solid rgba(255,255,255,0.06) !important;
        margin: 0 !important;
        text-align: left !important;
    }
    #recent-dropdown .menu-category-items,
    #undo-dropdown .menu-category-items {
        width: 100% !important;
        padding: 0 !important;
        margin: 0 !important;
        align-items: stretch !important;
    }
    .dropdown-menu .indexed-list {
        display: flex;
        flex-direction: column;
        width: 100%;
        gap: 0;
        background: transparent;
        align-items: stretch;
    }
    .dropdown-menu .dropdown-search {
        position: sticky;
        top: 0;
        z-index: 2;
        padding: 10px 12px;
        background: linear-gradient(0deg, #101010, #181818);
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    }
    .dropdown-menu .dropdown-search input {
        width: 100% !important;
        box-sizing: border-box !important;
        padding: 6px 9px !important;
        border-radius: 5px !important;
        border: 1px solid rgba(255, 255, 255, 0.12) !important;
        background: rgba(12, 12, 12, 0.9) !important;
        color: #dfe7f3 !important;
        font-size: 12px !important;
        font-family: 'Noto Sans JP', sans-serif !important;
        outline: none !important;
        box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.65);
    }
    .dropdown-menu .dropdown-search input:focus {
        border-color: rgba(0, 171, 192, 0.8) !important;
        background: rgba(15, 25, 30, 0.95) !important;
        box-shadow: 0 0 0 1px rgba(0, 171, 192, 0.45);
    }
    .dropdown-menu .indexed-scroll {
        width: 100%;
        transition: max-height 0.2s ease;
        overflow: hidden;
    }
    .dropdown-menu .indexed-scroll--clamped {
        padding-right: 4px;
    }
    .dropdown-menu .indexed-rows {
        display: flex;
        flex-direction: column;
        gap: 4px;
        padding: 6px 8px 10px;
        width: 100%;
        box-sizing: border-box;
    }
    .dropdown-menu .indexed-entry {
        display: flex;
        flex-direction: column;
        align-items: stretch;
        width: 100%;
        text-align: left;
        padding: 6px 10px;
        background: rgba(10, 10, 10, 0.55);
        border: 1px solid rgba(255, 255, 255, 0.08);
        color: #d9e2ed;
        font-size: 13px;
        border-radius: 6px;
        cursor: pointer;
        transition: background 140ms ease, border-color 140ms ease, transform 140ms ease;
        box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
    }
    .dropdown-menu .indexed-entry[style*="display: none"] {
        display: none !important;
    }
    .dropdown-menu .indexed-entry:hover {
        border-color: rgba(79, 195, 247, 0.5);
        background: rgba(20, 35, 45, 0.9);
        box-shadow: inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .dropdown-menu .indexed-entry__content {
        display: flex;
        flex-direction: column;
        gap: 4px;
        width: 100%;
    }
    .dropdown-menu .indexed-entry__heading {
        display: flex;
        align-items: center;
        gap: 6px;
        width: 100%;
    }
    .dropdown-menu .indexed-entry__index {
        /* Removed flex to allow natural width; zero outer spacing */
        min-width: 26px;
        text-align: right;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.4);
        font-variant-numeric: tabular-nums;
        margin: 0 !important;
        padding: 2px 4px !important;
    }

    /* Flush left alignment and zero extra right padding for recent & undo dropdown index lists */
    #recent-dropdown .indexed-rows,
    #undo-dropdown .indexed-rows { padding: 0 !important; margin: 0 !important; }
    #recent-dropdown .indexed-entry,
    #undo-dropdown .indexed-entry { padding: 6px 8px !important; margin: 0 !important; }
    #recent-dropdown .indexed-entry__heading,
    #undo-dropdown .indexed-entry__heading { display: flex; align-items: center; gap: 8px; }
    #recent-dropdown .indexed-entry__index,
    #undo-dropdown .indexed-entry__index { text-align: left !important; min-width: 34px; margin: 0 !important; padding: 2px 4px !important; }
    #recent-dropdown .indexed-entry__primary,
    #undo-dropdown .indexed-entry__primary { margin: 0 !important; }
    #recent-dropdown .indexed-entry__secondary,
    #undo-dropdown .indexed-entry__secondary { margin-left: 0 !important; padding: 2px 4px !important; }
    .dropdown-menu .indexed-entry__primary {
        font-weight: 600;
        color: rgba(255, 255, 255, 0.95);
        line-height: 1.2;
        flex: 1 1 auto;
        min-width: 0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    .dropdown-menu .indexed-entry__secondary {
        font-size: 11px;
        color: rgba(217, 226, 237, 0.5) !important;
        margin: 0 !important;
        max-width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        line-clamp: 2;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        padding: 2px 4px !important;
    }
    .dropdown-menu .recent-empty {
        padding: 8px 10px;
        font-size: 13px;
        color: #90a0b5;
    }
    .dropdown-menu .recent-empty--filtered {
        font-style: italic;
        color: rgba(255, 255, 255, 0.6);
    }
    .history-entry.redo {
        opacity: 0.55;
    }
    .history-entry.history-current {
        border-color: rgba(79, 195, 247, 0.45);
        box-shadow: inset 3px 0 0 rgba(79, 195, 247, 0.85);
        background: rgba(79, 195, 247, 0.08);
    }